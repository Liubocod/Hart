#include	"crc.h"
#include	"tim.h"
#include	"Eeprom.h"
#include	"RFHandle.h"
#include 	"DistanceDataHandle.h"
#include 	"ComLCDHandle.h"
#include	"EchoHandle.h"
#include	"IWR1443.h"
#include	"usart.h"
#include	"perf_management.h"
#include	"LCD485.h"
#include "arm_math.h"
#include "arm_common_tables.h"
#include "arm_const_structs.h"
#include <stdlib.h>
#include <math.h>

const	float Liquid_ONE_PONIT_M_Table[8] = {0.002747,0.005494,0.01099,0.02198,0.04396,0.04396,0.08791,0.17608};
const	float Solid_ONE_PONIT_M_Table[8] = {0.002747,0.005494,0.01099,0.02198,0.04396,0.04396,0.08791,0.17608};
const	float CpuFFT_ONE_PONIT_M_Table[8] = {0.005494,0.005494,0.005494,0.01099,0.02198,0.04396,0.08791,0.17608};

#define TABLE_CAL_SIZE  500
//FFT log 值表  升序表
const float FFT_LOG_TABLE[TABLE_CAL_SIZE][2]=
{
    {0.02020134  ,0.4  },
    {0.040810774 ,0.8  },
    {0.061836547 ,1.2  },
    {0.083287068 ,1.6  },
    {0.105170918 ,2    },
    {0.127496852 ,2.4  },
    {0.150273799 ,2.8  },
    {0.173510871 ,3.2  },
    {0.197217363 ,3.6  },
    {0.221402758 ,4    },
    {0.246076731 ,4.4  },
    {0.27124915  ,4.8  },
    {0.296930087 ,5.2  },
    {0.323129812 ,5.6  },
    {0.349858808 ,6    },
    {0.377127764 ,6.4  },
    {0.404947591 ,6.8  },
    {0.433329415 ,7.2  },
    {0.462284589 ,7.6  },
    {0.491824698 ,8    },
    {0.521961556 ,8.4  },
    {0.552707219 ,8.8  },
    {0.584073985 ,9.2  },
    {0.616074402 ,9.6  },
    {0.648721271 ,10   },
    {0.68202765  ,10.4 },
    {0.716006862 ,10.8 },
    {0.7506725   ,11.2 },
    {0.786038431 ,11.6 },
    {0.8221188   ,12   },
    {0.858928042 ,12.4 },
    {0.896480879 ,12.8 },
    {0.934792334 ,13.2 },
    {0.973877732 ,13.6 },
    {1.013752707 ,14   },
    {1.054433211 ,14.4 },
    {1.095935514 ,14.8 },
    {1.13827622  ,15.2 },
    {1.181472265 ,15.6 },
    {1.225540928 ,16   },
    {1.270499838 ,16.4 },
    {1.316366977 ,16.8 },
    {1.363160694 ,17.2 },
    {1.410899706 ,17.6 },
    {1.459603111 ,18   },
    {1.50929039  ,18.4 },
    {1.559981418 ,18.8 },
    {1.611696473 ,19.2 },
    {1.664456242 ,19.6 },
    {1.718281828 ,20   },
    {1.773194764 ,20.4 },
    {1.829217014 ,20.8 },
    {1.886370989 ,21.2 },
    {1.944679551 ,21.6 },
    {2.004166024 ,22   },
    {2.064854203 ,22.4 },
    {2.126768365 ,22.8 },
    {2.189933276 ,23.2 },
    {2.254374203 ,23.6 },
    {2.320116923 ,24   },
    {2.387187734 ,24.4 },
    {2.455613465 ,24.8 },
    {2.525421487 ,25.2 },
    {2.596639726 ,25.6 },
    {2.669296668 ,26   },
    {2.743421377 ,26.4 },
    {2.819043505 ,26.8 },
    {2.896193302 ,27.2 },
    {2.974901627 ,27.6 },
    {3.055199967 ,28   },
    {3.13712044  ,28.4 },
    {3.220695817 ,28.8 },
    {3.305959528 ,29.2 },
    {3.392945681 ,29.6 },
    {3.48168907  ,30   },
    {3.572225195 ,30.4 },
    {3.664590271 ,30.8 },
    {3.758821245 ,31.2 },
    {3.854955811 ,31.6 },
    {3.953032424 ,32   },
    {4.053090317 ,32.4 },
    {4.155169512 ,32.8 },
    {4.259310844 ,33.2 },
    {4.365555971 ,33.6 },
    {4.473947392 ,34   },
    {4.584528464 ,34.4 },
    {4.697343423 ,34.8 },
    {4.812437394 ,35.2 },
    {4.929856419 ,35.6 },
    {5.049647464 ,36   },
    {5.17185845  ,36.4 },
    {5.296538261 ,36.8 },
    {5.423736771 ,37.2 },
    {5.553504862 ,37.6 },
    {5.685894442 ,38   },
    {5.820958469 ,38.4 },
    {5.958750971 ,38.8 },
    {6.099327065 ,39.2 },
    {6.242742985 ,39.6 },
    {6.389056099 ,40   },
    {6.538324934 ,40.4 },
    {6.690609199 ,40.8 },
    {6.84596981  ,41.2 },
    {7.004468914 ,41.6 },
    {7.166169913 ,42   },
    {7.331137488 ,42.4 },
    {7.499437629 ,42.8 },
    {7.671137658 ,43.2 },
    {7.846306259 ,43.6 },
    {8.025013499 ,44   },
    {8.207330866 ,44.4 },
    {8.393331287 ,44.8 },
    {8.583089167 ,45.2 },
    {8.77668041  ,45.6 },
    {8.974182455 ,46   },
    {9.175674306 ,46.4 },
    {9.381236563 ,46.8 },
    {9.590951452 ,47.2 },
    {9.804902864 ,47.6 },
    {10.02317638 ,48   },
    {10.24585931 ,48.4 },
    {10.47304074 ,48.8 },
    {10.70481154 ,49.2 },
    {10.94126442 ,49.6 },
    {11.18249396 ,50   },
    {11.42859666 ,50.4 },
    {11.67967097 ,50.8 },
    {11.93581732 ,51.2 },
    {12.19713816 ,51.6 },
    {12.46373804 ,52   },
    {12.73572359 ,52.4 },
    {13.01320361 ,52.8 },
    {13.2962891  ,53.2 },
    {13.5850933  ,53.6 },
    {13.87973172 ,54   },
    {14.18032224 ,54.4 },
    {14.4869851  ,54.8 },
    {14.79984295 ,55.2 },
    {15.11902095 ,55.6 },
    {15.44464677 ,56   },
    {15.77685067 ,56.4 },
    {16.11576554 ,56.8 },
    {16.46152694 ,57.2 },
    {16.81427318 ,57.6 },
    {17.17414537 ,58   },
    {17.54128746 ,58.4 },
    {17.91584631 ,58.8 },
    {18.29797176 ,59.2 },
    {18.68781664 ,59.6 },
    {19.08553692 ,60   },
    {19.49129168 ,60.4 },
    {19.90524324 ,60.8 },
    {20.32755716 ,61.2 },
    {20.7584024  ,61.6 },
    {21.19795128 ,62   },
    {21.64637964 ,62.4 },
    {22.10386686 ,62.8 },
    {22.57059593 ,63.2 },
    {23.04675355 ,63.6 },
    {23.5325302  ,64   },
    {24.02812018 ,64.4 },
    {24.53372175 ,64.8 },
    {25.04953714 ,65.2 },
    {25.5757727  ,65.6 },
    {26.11263892 ,66   },
    {26.66035056 ,66.4 },
    {27.21912671 ,66.8 },
    {27.78919088 ,67.2 },
    {28.37077111 ,67.6 },
    {28.96410005 ,68   },
    {29.56941502 ,68.4 },
    {30.18695817 ,68.8 },
    {30.81697651 ,69.2 },
    {31.45972208 ,69.6 },
    {32.11545196 ,70   },
    {32.78442846 ,70.4 },
    {33.46691919 ,70.8 },
    {34.16319715 ,71.2 },
    {34.87354085 ,71.6 },
    {35.59823444 ,72   },
    {36.33756782 ,72.4 },
    {37.09183673 ,72.8 },
    {37.86134287 ,73.2 },
    {38.64639407 ,73.6 },
    {39.44730436 ,74   },
    {40.26439411 ,74.4 },
    {41.09799016 ,74.8 },
    {41.94842598 ,75.2 },
    {42.81604174 ,75.6 },
    {43.70118449 ,76   },
    {44.60420832 ,76.4 },
    {45.52547444 ,76.8 },
    {46.46535137 ,77.2 },
    {47.42421507 ,77.6 },
    {48.40244911 ,78   },
    {49.40044478 ,78.4 },
    {50.4186013  ,78.8 },
    {51.45732595 ,79.2 },
    {52.51703423 ,79.6 },
    {53.59815003 ,80   },
    {54.70110583 ,80.4 },
    {55.82634281 ,80.8 },
    {56.97431108 ,81.2 },
    {58.14546985 ,81.6 },
    {59.3402876  ,82   },
    {60.55924226 ,82.4 },
    {61.80282145 ,82.8 },
    {63.0715226  ,83.2 },
    {64.36585321 ,83.6 },
    {65.68633104 ,84   },
    {67.03348429 ,84.4 },
    {68.40785184 ,84.8 },
    {69.80998345 ,85.2 },
    {71.24044001 ,85.6 },
    {72.6997937  ,86   },
    {74.18862829 ,86.4 },
    {75.70753934 ,86.8 },
    {77.25713442 ,87.2 },
    {78.83803341 ,87.6 },
    {80.45086866 ,88   },
    {82.09628536 ,88.4 },
    {83.77494167 ,88.8 },
    {85.4875091  ,89.2 },
    {87.23467268 ,89.6 },
    {89.0171313  ,90   },
    {90.83559798 ,90.4 },
    {92.69080012 ,90.8 },
    {94.58347983 ,91.2 },
    {96.51439421 ,91.6 },
    {98.48431564 ,92   },
    {100.4940321 ,92.4 },
    {102.5443476 ,92.8 },
    {104.6360822 ,93.2 },
    {106.7700726 ,93.6 },
    {108.9471725 ,94   },
    {111.1682527 ,94.4 },
    {113.4342017 ,94.8 },
    {115.7459259 ,95.2 },
    {118.10435   ,95.6 },
    {120.5104175 ,96   },
    {122.9650908 ,96.4 },
    {125.4693517 ,96.8 },
    {128.0242021 ,97.2 },
    {130.6306639 ,97.6 },
    {133.2897797 ,98   },
    {136.0026132 ,98.4 },
    {138.7702496 ,98.8 },
    {141.5937959 ,99.2 },
    {144.4743817 ,99.6 },
    {147.4131591 ,100  },
    {150.4113038 ,100.4},
    {153.470015  ,100.8},
    {156.5905163 ,101.2},
    {159.7740559 ,101.6},
    {163.0219073 ,102  },
    {166.3353696 ,102.4},
    {169.7157683 ,102.8},
    {173.1644556 ,103.2},
    {176.682811  ,103.6},
    {180.2722419 ,104  },
    {183.9341841 ,104.4},
    {187.6701024 ,104.8},
    {191.4814913 ,105.2},
    {195.3698754 ,105.6},
    {199.33681   ,106  },
    {203.383882  ,106.4},
    {207.5127103 ,106.8},
    {211.7249464 ,107.2},
    {216.0222754 ,107.6},
    {220.4064162 ,108  },
    {224.8791225 ,108.4},
    {229.4421835 ,108.8},
    {234.0974244 ,109.2},
    {238.8467074 ,109.6},
    {243.6919323 ,110  },
    {248.6350372 ,110.4},
    {253.6779995 ,110.8},
    {258.8228363 ,111.2},
    {264.0716058 ,111.6},
    {269.4264074 ,112  },
    {274.8893832 ,112.4},
    {280.4627185 ,112.8},
    {286.1486426 ,113.2},
    {291.9494299 ,113.6},
    {297.867401  ,114  },
    {303.904923  ,114.4},
    {310.064411  ,114.8},
    {316.3483289 ,115.2},
    {322.7591904 ,115.6},
    {329.2995599 ,116  },
    {335.9720536 ,116.4},
    {342.7793407 ,116.8},
    {349.724144  ,117.2},
    {356.8092417 ,117.6},
    {364.0374679 ,118  },
    {371.4117139 ,118.4},
    {378.9349295 ,118.8},
    {386.6101242 ,119.2},
    {394.4403682 ,119.6},
    {402.4287935 ,120  },
    {410.5785957 ,120.4},
    {418.8930349 ,120.8},
    {427.3754369 ,121.2},
    {436.0291947 ,121.6},
    {444.8577701 ,122  },
    {453.8646945 ,122.4},
    {463.0535709 ,122.8},
    {472.4280748 ,123.2},
    {481.9919564 ,123.6},
    {491.7490411 ,124  },
    {501.703232  ,124.4},
    {511.8585109 ,124.8},
    {522.2189401 ,125.2},
    {532.7886638 ,125.6},
    {543.5719101 ,126  },
    {554.5729925 ,126.4},
    {565.7963114 ,126.8},
    {577.2463564 ,127.2},
    {588.9277077 ,127.6},
    {600.8450379 ,128  },
    {613.0031141 ,128.4},
    {625.4067998 ,128.8},
    {638.0610566 ,129.2},
    {650.9709463 ,129.6},
    {664.141633  ,130  },
    {677.5783853 ,130.4},
    {691.286578  ,130.8},
    {705.2716946 ,131.2},
    {719.5393292 ,131.6},
    {734.0951892 ,132  },
    {748.9450971 ,132.4},
    {764.094993  ,132.8},
    {779.5509371 ,133.2},
    {795.319112  ,133.6},
    {811.4058252 ,134  },
    {827.8175115 ,134.4},
    {844.5607359 ,134.8},
    {861.6421958 ,135.2},
    {879.0687241 ,135.6},
    {896.8472917 ,136  },
    {914.9850101 ,136.4},
    {933.4891347 ,136.8},
    {952.3670675 ,137.2},
    {971.6263598 ,137.6},
    {991.2747156 ,138  },
    {1011.319995 ,138.4},
    {1031.770215 ,138.8},
    {1052.633557 ,139.2},
    {1073.918367 ,139.6},
    {1095.633158 ,140  },
    {1117.786618 ,140.4},
    {1140.387607 ,140.8},
    {1163.445166 ,141.2},
    {1186.968519 ,141.6},
    {1210.967074 ,142  },
    {1235.450433 ,142.4},
    {1260.428389 ,142.8},
    {1285.910933 ,143.2},
    {1311.908258 ,143.6},
    {1338.430764 ,144  },
    {1365.489061 ,144.4},
    {1393.093971 ,144.8},
    {1421.256537 ,145.2},
    {1449.988025 ,145.6},
    {1479.299928 ,146  },
    {1509.20397  ,146.4},
    {1539.712114 ,146.8},
    {1570.836563 ,147.2},
    {1602.589768 ,147.6},
    {1634.98443  ,148  },
    {1668.033508 ,148.4},
    {1701.750221 ,148.8},
    {1736.148057 ,149.2},
    {1771.240776 ,149.6},
    {1807.042414 ,150  },
    {1843.567294 ,150.4},
    {1880.830025 ,150.8},
    {1918.845513 ,151.2},
    {1957.628965 ,151.6},
    {1997.195895 ,152  },
    {2037.56213  ,152.4},
    {2078.743817 ,152.8},
    {2120.757429 ,153.2},
    {2163.619772 ,153.6},
    {2207.347992 ,154  },
    {2251.959581 ,154.4},
    {2297.472383 ,154.8},
    {2343.904605 ,155.2},
    {2391.274821 ,155.6},
    {2439.601978 ,156  },
    {2488.905408 ,156.4},
    {2539.204834 ,156.8},
    {2590.520375 ,157.2},
    {2642.87256  ,157.6},
    {2696.282328 ,158  },
    {2750.771046 ,158.4},
    {2806.360508 ,158.8},
    {2863.072953 ,159.2},
    {2920.931064 ,159.6},
    {2979.957987 ,160  },
    {3040.177333 ,160.4},
    {3101.61319  ,160.8},
    {3164.290134 ,161.2},
    {3228.233237 ,161.6},
    {3293.468075 ,162  },
    {3360.020745 ,162.4},
    {3427.917868 ,162.8},
    {3497.186604 ,163.2},
    {3567.854661 ,163.6},
    {3639.950307 ,164  },
    {3713.502383 ,164.4},
    {3788.540308 ,164.8},
    {3865.0941   ,165.2},
    {3943.194382 ,165.6},
    {4022.872394 ,166  },
    {4104.160008 ,166.4},
    {4187.089741 ,166.8},
    {4271.694766 ,167.2},
    {4358.008926 ,167.6},
    {4446.066748 ,168  },
    {4535.903455 ,168.4},
    {4627.554985 ,168.8},
    {4721.057998 ,169.2},
    {4816.449897 ,169.6},
    {4913.76884  ,170  },
    {5013.053757 ,170.4},
    {5114.344362 ,170.8},
    {5217.681172 ,171.2},
    {5323.105525 ,171.6},
    {5430.659591 ,172  },
    {5540.386394 ,172.4},
    {5652.329824 ,172.8},
    {5766.534663 ,173.2},
    {5883.046591 ,173.6},
    {6001.912217 ,174  },
    {6123.179088 ,174.4},
    {6246.895712 ,174.8},
    {6373.111578 ,175.2},
    {6501.877173 ,175.6},
    {6633.244006 ,176  },
    {6767.264625 ,176.4},
    {6903.99264  ,176.8},
    {7043.482745 ,177.2},
    {7185.790736 ,177.6},
    {7330.973539 ,178  },
    {7479.08923  ,178.4},
    {7630.197056 ,178.8},
    {7784.357462 ,179.2},
    {7941.632116 ,179.6},
    {8102.083928 ,180  },
    {8265.777081 ,180.4},
    {8432.777056 ,180.8},
    {8603.150654 ,181.2},
    {8776.966027 ,181.6},
    {8954.292703 ,182  },
    {9135.201616 ,182.4},
    {9319.765132 ,182.8},
    {9508.057078 ,183.2},
    {9700.152773 ,183.6},
    {9896.129059 ,184  },
    {10096.06433 ,184.4},
    {10300.03856 ,184.8},
    {10508.13334 ,185.2},
    {10720.43192 ,185.6},
    {10937.01921 ,186  },
    {11157.98185 ,186.4},
    {11383.40824 ,186.8},
    {11613.38854 ,187.2},
    {11848.01475 ,187.6},
    {12087.38073 ,188  },
    {12331.58222 ,188.4},
    {12580.71691 ,188.8},
    {12834.88445 ,189.2},
    {13094.18651 ,189.6},
    {13358.72683 ,190  },
    {13628.61121 ,190.4},
    {13903.94762 ,190.8},
    {14184.8462  ,191.2},
    {14471.4193  ,191.6},
    {14763.78157 ,192  },
    {15062.04994 ,192.4},
    {15366.34373 ,192.8},
    {15676.78467 ,193.2},
    {15993.49693 ,193.6},
    {16316.6072  ,194  },
    {16646.24473 ,194.4},
    {16982.54138 ,194.8},
    {17325.63168 ,195.2},
    {17675.65285 ,195.6},
    {18032.74493 ,196  },
    {18397.05074 ,196.4},
    {18768.71602 ,196.8},
    {19147.88944 ,197.2},
    {19534.72266 ,197.6},
    {19929.37044 ,198  },
    {20331.99063 ,198.4},
    {20742.74429 ,198.8},
    {21161.79572 ,199.2},
    {21589.31255 ,199.6},
    {22025.46579 ,200  },

};
/*********************布莱克曼窗系数****************
*
*如果修改采样点个数需要重新计算
*
****************************************************/
const float32_t WIN_BLACKMAN[512]= {
	-3.30430133E-17 ,  
	3.2399893822E-5 ,  
	1.29620792E-4	,	 
	2.9172634822E-4 ,  
	5.18822576E-4	,	 
	8.11057805E-4	,	 
	1.1686224022E-3 ,  
	1.5917489E-3	,	 
	2.08071107E-3	,	 
	2.6358251922E-3 ,  
	3.2574478533E-3 ,  
	3.9459769611E-3 ,  
	4.70185047E-3	,	 
	5.52554708E-3	,	 
	6.41758646E-3	,	 
	7.3785237033E-3 ,  
	8.40895623E-3	,	 
	9.5095206E-3	,	 
	1.0680885E-2	,	 
	1.19237611E-2	,	 
	1.32388956E-2	,	 
	1.4627066444E-2 ,  
	1.6089092944E-2 ,  
	1.76258217E-2	,	 
	1.92381441E-2	,	 
	2.09269709E-2	,	 
	2.26932484E-2	,	 
	2.4537961933E-2 ,  
	2.64621228E-2	,	 
	2.8466761111E-2 ,  
	3.0552951611E-2 ,  
	3.27217839E-2	,	 
	3.4974381322E-2 ,  
	3.7311889233E-2 ,  
	3.97354737E-2	,	 
	4.2246330522E-2 ,  
	4.4845666733E-2 ,  
	4.7534722833E-2 ,  
	5.03147617E-2	,	 
	5.31870424E-2	,	 
	5.61528653E-2	,	 
	5.9213511644E-2 ,  
	6.23703412E-2	,	 
	6.56246543E-2	,	 
	6.89778328E-2	,	 
	7.24311843E-2	,	 
	7.5986102222E-2 ,  
	7.9643972211E-2 ,  
	8.3406150344E-2 ,  
	8.72740447E-2	,	 
	9.12490189E-2	,	 
	9.5332466E-2	,	 
	9.9525801833E-2 ,  
	1.03830404E-1	,	 
	1.0824769733E-1 ,  
	1.1277900633E-1 ,  
	1.17425777E-1	,	 
	1.22189343E-1	,	 
	1.27071082E-1	,	 
	1.3207238911E-1 ,  
	1.37194559E-1	,	 
	1.42438978E-1	,	 
	1.47806897E-1	,	 
	1.53299734E-1	,	 
	1.58918693E-1	,	 
	1.64665088E-1	,	 
	1.70540198E-1	,	 
	1.76545187E-1	,	 
	1.82681337E-1	,	 
	1.88949778E-1	,	 
	1.95351734E-1	,	 
	2.0188827811E-1 ,  
	2.0856054122E-1 ,  
	2.15369612E-1	,	 
	2.2231654822E-1 ,  
	2.2940236333E-1 ,  
	2.36627996E-1	,	 
	2.43994414E-1	,	 
	2.5150260322E-1 ,  
	2.5915330644E-1 ,  
	2.6694744822E-1 ,  
	2.74885773E-1	,	 
	2.8296896811E-1 ,  
	2.91197955E-1	,	 
	2.99573183E-1	,	 
	3.08095336E-1	,	 
	3.1676498E-1	,	 
	3.25582742E-1	,	 
	3.3454886E-1	,	 
	3.43663901E-1	,	 
	3.52928251E-1	,	 
	3.62342178E-1	,	 
	3.7190598244E-1 ,  
	3.81619811E-1	,	 
	3.91483962E-1	,	 
	4.01498317E-1	,	 
	4.11663025E-1	,	 
	4.2197808622E-1 ,  
	4.3244344E-1	,	 
	4.43058669E-1	,	 
	4.5382401344E-1 ,
	4.64738875E-1	,  
	4.7580304744E-1 ,
	4.87016111E-1	,  
	4.98377561E-1	,  
	5.0988709922E-1 ,
	5.21543681E-1	,  
	5.33347129E-1	,  
	5.4529643E-1	,  
	5.5739092822E-1 ,
	5.6962966911E-1 ,
	5.8201187844E-1 ,
	5.94536364E-1	,  
	6.0720199344E-1 ,
	6.20007991E-1	,  
	6.3295280933E-1 ,
	6.4603537322E-1 ,
	6.59254253E-1	,  
	6.72608196E-1	,  
	6.86095357E-1	,  
	6.9971442222E-1 ,
	7.13463664E-1	,  
	7.2734159233E-1 ,
	7.41346001E-1	,  
	7.5547546144E-1 ,
	7.69728064E-1	,  
	7.84101545E-1	,  
	7.98593878E-1	,  
	8.13203156E-1	,  
	8.27927231E-1	,  
	8.42763304E-1	,  
	8.57709705E-1	,  
	8.7276357411E-1 ,
	8.8792282344E-1 ,
	9.0318435433E-1 ,
	9.18546021E-1	,  
	9.340052E-1 ,	 
	9.4955867522E-1 ,
	9.65204238E-1	,  
	9.8093861344E-1 ,
	9.96759057E-1	,  
	1.0126622911	,  
	1.0286456344	,  
	1.04470574	,	 
	1.0608394144	,  
	1.0770435333	,  
	1.09331464	,	 
	1.10964977	,	 
	1.12604475	,	 
	1.1424970622	,  
	1.1590024233	,  
	1.1755574944	,  
	1.19215881	,	 
	1.20880258	,	 
	1.22548472	,	 
	1.2422021622	,  
	1.2589504711	,  
	1.2757262	,
	1.2925250533	,  
	1.30934321	,	 
	1.326177	, 
	1.34302175	,	 
	1.35987401	,	 
	1.37672925	,	 
	1.39358317	,	 
	1.41043233	,	 
	1.4272719622	,  
	1.44409799	,	 
	1.46090579	,	 
	1.47769165	,	 
	1.49445033	,	 
	1.51117825	,	 
	1.5278712511	,  
	1.5445243122	,  
	1.5611335033	,  
	1.5776937	, 
	1.59420132	,	 
	1.61065089	,	 
	1.6270390744	,  
	1.6433606144	,  
	1.6596115822	,  
	1.6757870911	,  
	1.6918824911	,  
	1.70789373	,	 
	1.72381603	,	 
	1.7396452422	,  
	1.75537633	,	 
	1.7710053922	,  
	1.7865277522	,  
	1.8019388911	,  
	1.81723392	,	 
	1.8324090244	,  
	1.8474599122	,  
	1.86238157	,	 
	1.87717008	,	 
	1.89182102	,	 
	1.9063301	, 
	1.9206924433	,  
	1.93490421	,	 
	1.94896149	,	 
	1.96285975	,	 
	1.97659444	,	 
	1.9901620144	,  
	2.00355792	,	 
	2.01677823	,	 
	2.0298190111	,  
	2.04267621	,	 
	2.0553460122	,  
	2.06782412	,	 
	2.0801069733	,  
	2.09219098	,	 
	2.1040720933	,  
	2.1157460211	,  
	2.12721061	,	 
	2.1384611122	,  
	2.1494941711	,  
	2.1603066922	,  
	2.1708951	,
	2.18125581	,	 
	2.19138574	,	 
	2.2012820244	,  
	2.21094083	,	 
	2.2203595633	,  
	2.2295351022	,  
	2.2384645933	,  
	2.24714493	,	 
	2.2555735111	,  
	2.26374793	,	 
	2.27166509	,	 
	2.2793226244	,  
	2.2867178911	,  
	2.2938489911	,  
	2.3007130622	,  
	2.30730819	,	 
	2.3136320111	,  
	2.31968283	,	 
	2.32545852	,	 
	2.3309571744	,  
	2.33617711	,	 
	2.34111619	,	 
	2.34577322	,	 
	2.35014677	,	 
	2.3542351722	,  
	2.3580372333	,  
	2.3615517611	,  
	2.36477708	,	 
	2.36771273	,	 
	2.3703575133	,  
	2.3727107044	,  
	2.37477159	,	 
	2.37653923	,	 
	2.37801289	,	 
	2.37919259	,	 
	2.3800776	,
	2.3806679244	,  
	2.38096308	,	 
	2.38096308	,	 
	2.3806679244	,  
	2.3800776	,
	2.37919259	,	 
	2.37801289	,	 
	2.37653923	,	 
	2.37477159	,	 
	2.3727107044	,  
	2.3703575133	,  
	2.36771273	,	 
	2.36477708	,	 
	2.3615515233	,  
	2.3580372333	,  
	2.3542351722	,  
	2.35014677	,	 
	2.34577322	,	 
	2.34111619	,	 
	2.3361766333	,  
	2.3309571744	,  
	2.32545852	,	 
	2.31968283	,	 
	2.3136320111	,  
	2.30730795	,	 
	2.3007128233	,  
	2.2938487522	,  
	2.2867178911	,  
	2.27932238	,	 
	2.27166485	,	 
	2.2637476922	,  
	2.2555735111	,  
	2.2471447	,
	2.23846435	,	 
	2.2295348644	,  
	2.2203595633	,  
	2.21094083	,	 
	2.20128178	,	 
	2.19138574	,	 
	2.18125557	,	 
	2.1708948611	,  
	2.1603066922	,  
	2.1494941711	,  
	2.1384608744	,  
	2.12721037	,	 
	2.1157460211	,  
	2.10407185	,	 
	2.09219098	,	 
	2.0801069733	,  
	2.06782412	,	 
	2.0553457733	,  
	2.0426759711	,  
	2.0298187733	,  
	2.01677823	,	 
	2.00355792	,	 
	1.99016177	,	 
	1.97659421	,	 
	1.9628595111	,  
	1.94896137	,	 
	1.93490398	,	 
	1.9206922	,
	1.9063297511	,  
	1.8918209	,
	1.87716996	,	 
	1.86238157	,	 
	1.8474596733	,  
	1.83240878	,	 
	1.8172335622	,  
	1.8019386522	,  
	1.7865275144	,  
	1.7710051533	,  
	1.7553759811	,  
	1.7396450044	,  
	1.72381615	,	 
	1.70789384	,	 
	1.6918821333	,  
	1.6757867333	,  
	1.6596115822	,  
	1.64336037	,	 
	1.62703895	,	 
	1.61065042	,	 
	1.59420073	,	 
	1.5776934622	,  
	1.56113255	,	 
	1.54452383	,	 
	1.5278708933	,  
	1.5111784933	,  
	1.49445045	,	 
	1.47769165	,	 
	1.4609054322	,  
	1.44409775	,	 
	1.42727148	,	 
	1.4104321	,
	1.39358329	,	 
	1.3767286533	,  
	1.3598735333	,  
	1.34302175	,	 
	1.32617628	,	 
	1.3093428611	,  
	1.29252553	,	 
	1.27572596	,	 
	1.25895071	,	 
	1.24220168	,	 
	1.22548472	,	 
	1.2088024611	,  
	1.1921583411	,  
	1.17555725	,	 
	1.1590023044	,  
	1.14249646	,	 
	1.1260445111	,  
	1.10964942	,	 
	1.09331417	,	 
	1.07704305	,	 
	1.06083917	,	 
	1.04470563	,	 
	1.0286457533	,  
	1.0126620533	,  
	9.96758818E-1	,  
	9.80938673E-1	,  
	9.6520388122E-1 ,
	9.49558615E-1	,  
	9.340052E-1 ,	 
	9.1854566333E-1 ,
	9.03184115E-1	,  
	8.87921989E-1	,  
	8.7276309722E-1 ,
	8.5770934822E-1 ,
	8.4276324511E-1 ,
	8.2792717211E-1 ,
	8.1320339444E-1 ,
	7.985937E-1 ,	 
	7.8410148622E-1 ,
	7.6972812411E-1 ,
	7.55475282E-1	,  
	7.41346001E-1	,  
	7.2734099622E-1 ,
	7.13463366E-1	,  
	6.99714183E-1	,  
	6.8609476E-1	,  
	6.7260766022E-1 ,
	6.59254074E-1	,  
	6.46035313E-1	,  
	6.32952928E-1	,  
	6.2000823022E-1 ,
	6.0720187422E-1 ,
	5.94536244E-1	,  
	5.8201146122E-1 ,
	5.6962949033E-1 ,
	5.57390868E-1	,  
	5.45296073E-1	,  
	5.3334689144E-1 ,
	5.21543622E-1	,  
	5.09886562E-1	,  
	4.9837729333E-1 ,
	4.87015932E-1	,  
	4.75802987E-1	,  
	4.6473893522E-1 ,
	4.53823775E-1	,  
	4.43058639E-1	,  
	4.3244341011E-1 ,
	4.21977818E-1	,  
	4.1166290644E-1 ,
	4.01498288E-1	,  
	3.91483664E-1	,  
	3.81619662E-1	,  
	3.71905952E-1	,  
	3.6234188E-1	,  
	3.5292804244E-1 ,
	3.43663454E-1	,  
	3.34548831E-1	,  
	3.2558277244E-1 ,
	3.1676486133E-1 ,
	3.0809530611E-1 ,
	2.99573242E-1	,  
	2.91197747E-1	,  
	2.8296893833E-1 ,
	2.74885773E-1	,  
	2.66947239E-1	,  
	2.5915318722E-1 ,
	2.5150227544E-1 ,
	2.4399420611E-1 ,
	2.36627847E-1	,  
	2.29402288E-1	,  
	2.22316578E-1	,  
	2.1536971622E-1 ,
	2.08560437E-1	,  
	2.0188823344E-1 ,
	1.95351764E-1	,  
	1.8894965944E-1 ,
	1.8268127733E-1 ,
	1.7654496433E-1 ,
	1.70540049E-1	,  
	1.6466502844E-1 ,
	1.5891847011E-1 ,
	1.53299585E-1	,  
	1.4780682322E-1 ,
	1.4243893322E-1 ,
	1.37194573E-1	,  
	1.32072463E-1	,  
	1.27071037E-1	,  
	1.22189343E-1	,  
	1.1742565033E-1 ,
	1.12778946E-1	,  
	1.08247667E-1	,  
	1.0383028533E-1 ,
	9.95257198E-2	,  
	9.53324213E-2	,  
	9.1248855E-2	,  
	8.7273925544E-2 ,
	8.3406090733E-2 ,
	7.9643957311E-2 ,
	7.5986132022E-2 ,
	7.24311173E-2	,  
	6.8977795544E-2 ,
	6.5624676644E-2 ,
	6.23702667E-2	,  
	5.9213481844E-2 ,
	5.6152854111E-2 ,
	5.3186960511E-2 ,
	5.03147132E-2	,  
	4.75347116E-2	,  
	4.4845577322E-2 ,
	4.2246270922E-2 ,
	3.97353507E-2	,  
	3.7311889233E-2 ,
	3.49744074E-2	,  
	3.2721750433E-2 ,
	3.05529441E-2	,  
	2.8466776011E-2 ,
	2.64620799E-2	,  
	2.45379451E-2	,  
	2.26932522E-2	,  
	2.0926924422E-2 ,
	1.9238119944E-2 ,
	1.76257565E-2	,  
	1.60890463E-2	,  
	1.46270385E-2	,  
	1.3238831422E-2 ,
	1.19237657E-2	,  
	1.0680902744E-2 ,
	9.5095057044E-3 ,
	8.40895529E-3	,  
	7.3785334822E-3 ,
	6.4175697044E-3 ,
	5.52554195E-3	,  
	4.70182392E-3	,  
	3.9459606633E-3 ,
	3.2574404033E-3 ,
	2.6358026E-3	,  
	2.08069686E-3	,  
	1.5917415733E-3 ,
	1.1686055222E-3 ,
	8.1106001744E-4 ,
	5.18827291E-4	,  
	2.91724543E-4	,  
	1.29621054E-4	,  
	3.2398238544E-5 ,
	6.54251679E-15	,
	};

const float32_t WIN_BLACKMAN_1024[1024]= {
    
    -3.30430133E-17	, 
    8.0838144644E-6	, 
    3.2336582E-5	,   
    7.2762246411E-5	, 
    1.29367457E-4	,   
    2.0216142E-4	,   
    2.9115597133E-4	, 
    3.96365794E-4	,   
    5.17807901E-4	,   
    6.55502081E-4	,   
    8.09470831E-4	,   
    9.7973900844E-4	, 
    1.1663341422E-3	, 
    1.36928702E-3	,   
    1.58863014E-3	,   
    1.8243988744E-3	, 
    2.0766314111E-3	, 
    2.3453680333E-3	, 
    2.63065192E-3	,   
    2.93252943E-3	,   
    3.25104827E-3	,   
    3.58625943E-3	,   
    3.9382157844E-3	, 
    4.3069734233E-3	, 
    4.6925912611E-3	, 
    5.09513029E-3	,   
    5.5146520022E-3	, 
    5.95122482E-3	,   
    6.40491442E-3	,   
    6.87579251E-3	,   
    7.3639336044E-3	, 
    7.86941032E-3	,   
    8.39230325E-3	,   
    8.93269013E-3	,   
    9.49065573E-3	,   
    1.0066282E-2	,   
    1.06596583E-2	,   
    1.12708741E-2	,   
    1.19000217E-2	,   
    1.25471931E-2	,   
    1.32124871E-2	,   
    1.38959987E-2	,   
    1.45978313E-2	,   
    1.53180835E-2	,   
    1.6056867311E-2	, 
    1.68142858E-2	,   
    1.7590444533E-2	, 
    1.83854606E-2	,   
    1.9199442111E-2	, 
    2.00325138E-2	,   
    2.08847783E-2	,   
    2.17563659E-2	,   
    2.2647390144E-2	, 
    2.35579814E-2	,   
    2.44882609E-2	,   
    2.54383515E-2	,   
    2.6408389211E-2	, 
    2.73985024E-2	,   
    2.8408814222E-2	, 
    2.94394716E-2	,   
    3.04906033E-2	,   
    3.15623469E-2	,   
    3.26548367E-2	,   
    3.3768221733E-2	, 
    3.49026396E-2	,   
    3.60582321E-2	,   
    3.72351482E-2	,   
    3.8433525711E-2	, 
    3.96535322E-2	,   
    4.08952906E-2	,   
    4.2158968744E-2	, 
    4.3444711711E-2	, 
    4.47526797E-2	,   
    4.60830219E-2	,   
    4.74358871E-2	,   
    4.88114506E-2	,   
    5.02098538E-2	,   
    5.16312606E-2	,   
    5.30758351E-2	,   
    5.45437298E-2	,   
    5.60351237E-2	,   
    5.75501583E-2	,   
    5.90890161E-2	,   
    6.06518425E-2	,   
    6.22388348E-2	,   
    6.38501048E-2	,   
    6.5485887222E-2	, 
    6.71463161E-2	,   
    6.88315481E-2	,   
    7.05417692E-2	,   
    7.22771585E-2	,   
    7.40378573E-2	,   
    7.58240521E-2	,   
    7.7635936433E-2	, 
    7.9473637044E-2	, 
    8.13373699E-2	,   
    8.32272544E-2	,   
    8.5143536322E-2	, 
    8.70863422E-2	,   
    8.90558213E-2	,   
    9.1052211822E-2	, 
    9.30756554E-2	,   
    9.51263085E-2	,   
    9.72043573E-2	,   
    9.9309973411E-2	, 
    1.01443357E-1	,   
    1.03604644E-1	,   
    1.0579402E-1	,   
    1.0801168533E-1	, 
    1.1025776711E-1	, 
    1.1253245911E-1	, 
    1.14835962E-1	,   
    1.17168396E-1	,   
    1.19529955E-1	,   
    1.21920831E-1	,   
    1.24341152E-1	,   
    1.26791119E-1	,   
    1.2927091122E-1	, 
    1.3178065411E-1	, 
    1.34320572E-1	,   
    1.36890769E-1	,   
    1.39491453E-1	,   
    1.4212280511E-1	, 
    1.4478491244E-1	, 
    1.47478044E-1	,   
    1.5020230411E-1	, 
    1.52957841E-1	,   
    1.55744835E-1	,   
    1.58563464E-1	,   
    1.6141384844E-1	, 
    1.6429616511E-1	, 
    1.67210564E-1	,   
    1.70157238E-1	,   
    1.73136323E-1	,   
    1.7614787811E-1	, 
    1.7919220033E-1	, 
    1.8226937944E-1	, 
    1.8537949022E-1	, 
    1.88522786E-1	,   
    1.91699355E-1	,   
    1.94909378E-1	,   
    1.9815294444E-1	, 
    2.0143021644E-1	, 
    2.04741373E-1	,   
    2.08086475E-1	,   
    2.11465686E-1	,   
    2.14879185E-1	,   
    2.1832703E-1	,   
    2.2180938722E-1	, 
    2.25326389E-1	,   
    2.28878125E-1	,   
    2.32464745E-1	,   
    2.3608638344E-1	, 
    2.39743098E-1	,   
    2.43435055E-1	,   
    2.47162371E-1	,   
    2.50925123E-1	,   
    2.5472345944E-1	, 
    2.5855737922E-1	, 
    2.6242712144E-1	, 
    2.66332745E-1	,   
    2.70274281E-1	,   
    2.74251937E-1	,   
    2.78265655E-1	,   
    2.8231576E-1	,   
    2.8640207644E-1	, 
    2.9052484033E-1	, 
    2.94684171E-1	,   
    2.98879981E-1	,   
    3.0311244722E-1	, 
    3.0738157033E-1	, 
    3.1168761844E-1	, 
    3.16030472E-1	,   
    3.20410221E-1	,   
    3.2482704522E-1	, 
    3.2928082344E-1	, 
    3.33771705E-1	,   
    3.3829975122E-1	, 
    3.4286496044E-1	, 
    3.4746742244E-1	, 
    3.52107256E-1	,   
    3.56784314E-1	,   
    3.6149874322E-1	, 
    3.6625063411E-1	, 
    3.7103974811E-1	, 
    3.7586641311E-1	, 
    3.80730629E-1	,   
    3.85632217E-1	,   
    3.9057129622E-1	, 
    3.95547896E-1	,   
    4.00562077E-1	,   
    4.0561360122E-1	, 
    4.1070270533E-1	, 
    4.15829449E-1	,   
    4.20993566E-1	,   
    4.2619520422E-1	, 
    4.31434393E-1	,   
    4.36710953E-1	,   
    4.42024827E-1	,   
    4.4737631E-1	,   
    4.5276507733E-1	, 
    4.5819115633E-1	, 
    4.6365466711E-1	, 
    4.6915534133E-1	, 
    4.74693209E-1	,   
    4.8026812E-1	,   
    4.85880375E-1	,   
    4.91529584E-1	,   
    4.97215747E-1	,   
    5.02938985E-1	,   
    5.0869894022E-1	, 
    5.1449567E-1	,   
    5.2032905811E-1	, 
    5.2619910244E-1	, 
    5.3210568422E-1	, 
    5.3804874422E-1	, 
    5.4402810333E-1	, 
    5.50043642E-1	,   
    5.56095361E-1	,   
    5.6218308211E-1	, 
    5.68306744E-1	,   
    5.74466288E-1	,   
    5.80661416E-1	,   
    5.8689206833E-1	, 
    5.9315818544E-1	, 
    5.99459529E-1	,   
    6.0579603911E-1	, 
    6.12167596E-1	,   
    6.18574082E-1	,   
    6.25015139E-1	,   
    6.31490767E-1	,   
    6.38000905E-1	,   
    6.44545018E-1	,   
    6.51123344E-1	,   
    6.57735645E-1	,   
    6.64381504E-1	,   
    6.71060919E-1	,   
    6.7777383322E-1	, 
    6.8451970811E-1	, 
    6.91298365E-1	,   
    6.98110103E-1	,   
    7.04954207E-1	,   
    7.11830675E-1	,   
    7.18739211E-1	,   
    7.2567987444E-1	, 
    7.32652008E-1	,   
    7.39655494E-1	,   
    7.46690452E-1	,   
    7.53756284E-1	,   
    7.6085287333E-1	, 
    7.6798003911E-1	, 
    7.75137364E-1	,   
    7.8232473133E-1	, 
    7.89541781E-1	,   
    7.9678839444E-1	, 
    8.04064154E-1	,   
    8.11369001E-1	,   
    8.18702399E-1	,   
    8.26064229E-1	,   
    8.33454132E-1	,   
    8.4087187E-1	,   
    8.48317086E-1	,   
    8.55789601E-1	,   
    8.6328917744E-1	, 
    8.7081521744E-1	, 
    8.78367602E-1	,   
    8.85946095E-1	,   
    8.9355003833E-1	, 
    9.01179432E-1	,   
    9.08834099E-1	,   
    9.1651326411E-1	, 
    9.24216806E-1	,   
    9.31944608E-1	,   
    9.39695894E-1	,   
    9.47470367E-1	,   
    9.5526820422E-1	, 
    9.63088452E-1	,   
    9.7093105311E-1	, 
    9.7879552844E-1	, 
    9.8668175933E-1	, 
    9.9458897111E-1	, 
    1.00251686	,     
    1.0104655022	,   
    1.01843404	,     
    1.0264222622	,   
    1.0344299	,       
    1.04245627	,     
    1.0505011	,       
    1.05856406	,     
    1.06664466	,     
    1.07474255	,     
    1.08285737	,     
    1.09098863	,     
    1.09913575	,     
    1.1072986122	,   
    1.1154766	,       
    1.12366926	,     
    1.13187635	,     
    1.14009738	,     
    1.1483316422	,   
    1.15657901	,     
    1.16483891	,     
    1.1731108422	,   
    1.18139445	,     
    1.18968939	,     
    1.19799482	,     
    1.20631063	,     
    1.21463632	,     
    1.2229710811	,   
    1.23131489	,     
    1.23966717	,     
    1.2480272	,       
    1.2563946244	,   
    1.26476907	,     
    1.27315008	,     
    1.28153669	,     
    1.2899290322	,   
    1.2983264922	,   
    1.3067282433	,   
    1.31513393	,     
    1.32354331	,     
    1.3319555522	,   
    1.34037006	,     
    1.34878695	,     
    1.3572050333	,   
    1.36562407	,     
    1.37404334	,     
    1.38246274	,     
    1.39088177	,     
    1.3992993833	,   
    1.40771532	,     
    1.4161291122	,   
    1.4245401622	,   
    1.4329479933	,   
    1.44135236	,     
    1.4497522111	,   
    1.45814704	,     
    1.4665366411	,   
    1.4749201533	,   
    1.48329734	,     
    1.4916671511	,   
    1.50003016	,     
    1.50838458	,     
    1.51673054	,     
    1.52506721	,     
    1.53339421	,     
    1.5417109722	,   
    1.55001723	,     
    1.5583117	,       
    1.5665943622	,   
    1.5748645	,       
    1.58312153	,     
    1.59136509	,     
    1.5995944733	,   
    1.60780918	,     
    1.61600852	,     
    1.62419211	,     
    1.63235938	,     
    1.6405097244	,   
    1.64864254	,     
    1.6567575933	,   
    1.6648538111	,   
    1.67293071	,     
    1.6809880733	,   
    1.6890250444	,   
    1.6970411533	,   
    1.7050361633	,   
    1.7130086422	,   
    1.72095894	,     
    1.72888612	,     
    1.7367895844	,   
    1.74466896	,     
    1.75252378	,     
    1.76035308	,     
    1.76815641	,     
    1.7759333844	,   
    1.7836833	,       
    1.79140567	,     
    1.7990999222	,   
    1.8067659133	,   
    1.8144023411	,   
    1.82200872	,     
    1.82958507	,     
    1.83713054	,     
    1.84464466	,     
    1.85212707	,     
    1.8595765822	,   
    1.86699318	,     
    1.87437617	,     
    1.8817249533	,   
    1.88903904	,     
    1.89631831	,     
    1.9035614722	,   
    1.91076827	,     
    1.9179383511	,   
    1.9250706433	,   
    1.9321653844	,   
    1.93922174	,     
    1.9462393522	,   
    1.95321726	,     
    1.96015513	,     
    1.96705257	,     
    1.9739089011	,   
    1.98072362	,     
    1.98749649	,     
    1.9942265744	,   
    2.00091362	,     
    2.00755691	,     
    2.0141563411	,   
    2.0207107	,       
    2.02722025	,     
    2.0336844922	,   
    2.0401022433	,   
    2.0464735033	,   
    2.05279755	,     
    2.0590741633	,   
    2.06530261	,     
    2.07148289	,     
    2.07761383	,     
    2.0836954111	,   
    2.0897269244	,   
    2.0957078933	,   
    2.10163807	,     
    2.1075170044	,   
    2.1133441922	,   
    2.11911892	,     
    2.1248409744	,   
    2.1305100911	,   
    2.13612532	,     
    2.14168667	,     
    2.14719367	,     
    2.15264582	,     
    2.15804243	,     
    2.16338324	,     
    2.1686680311	,   
    2.1738960744	,   
    2.1790671344	,   
    2.1841809744	,   
    2.18923688	,     
    2.1942343711	,   
    2.19917345	,     
    2.20405364	,     
    2.2088744644	,   
    2.2136354444	,   
    2.2183363433	,   
    2.22297644	,     
    2.2275557511	,   
    2.2320740222	,   
    2.2365305422	,   
    2.2409250733	,   
    2.24525714	,     
    2.24952674	,     
    2.25373339	,     
    2.2578766344	,   
    2.26195597	,     
    2.26597166	,     
    2.2699229711	,   
    2.2738094322	,   
    2.2776310444	,   
    2.28138733	,     
    2.28507828	,     
    2.2887032033	,   
    2.29226207	,     
    2.2957541944	,   
    2.2991797922	,   
    2.3025383944	,   
    2.3058297633	,   
    2.3090534211	,   
    2.3122096	,       
    2.3152976033	,   
    2.3183171744	,   
    2.32126832	,     
    2.3241505622	,   
    2.3269639011	,   
    2.3297081	,       
    2.33238267	,     
    2.33498764	,     
    2.3375225	,       
    2.33998727	,     
    2.3423819544	,   
    2.34470605	,     
    2.34695959	,     
    2.3491420744	,   
    2.35125351	,     
    2.35329389	,     
    2.35526275	,     
    2.3571600911	,   
    2.3589856622	,   
    2.36073947	,     
    2.3624212744	,   
    2.36403107	,     
    2.3655684	,       
    2.3670332433	,   
    2.36842584	,     
    2.3697457311	,   
    2.37099289	,     
    2.37216711	,     
    2.3732686044	,   
    2.3742969033	,   
    2.37525224	,     
    2.37613415	,     
    2.3769431111	,   
    2.3776786322	,   
    2.3783407211	,   
    2.37892937	,     
    2.3794446	,       
    2.37988638	,     
    2.3802545	,       
    2.3805489544	,   
    2.38076996	,     
    2.3809170722	,   
    2.3809907433	,   
    2.3809907433	,   
    2.3809170722	,   
    2.38076996	,     
    2.3805489544	,   
    2.3802545	,       
    2.37988638	,     
    2.3794446	,       
    2.37892937	,     
    2.3783407211	,   
    2.3776786322	,   
    2.3769431111	,   
    2.37613415	,     
    2.37525224	,     
    2.3742969033	,   
    2.3732686044	,   
    2.37216711	,     
    2.37099289	,     
    2.3697457311	,   
    2.36842584	,     
    2.3670332433	,   
    2.3655681611	,   
    2.36403083	,     
    2.3624212744	,   
    2.36073947	,     
    2.3589856622	,   
    2.3571600911	,   
    2.35526275	,     
    2.35329389	,     
    2.35125351	,     
    2.3491420744	,   
    2.34695959	,     
    2.34470605	,     
    2.3423819544	,   
    2.33998727	,     
    2.3375225	,       
    2.3349874011	,   
    2.33238267	,     
    2.3297081	,       
    2.3269639011	,   
    2.3241505622	,   
    2.32126832	,     
    2.3183171744	,   
    2.3152976033	,   
    2.3122096	,       
    2.3090534211	,   
    2.3058295244	,   
    2.3025383944	,   
    2.2991797922	,   
    2.29575395	,     
    2.29226183	,     
    2.2887032033	,   
    2.28507804	,     
    2.28138733	,     
    2.2776310444	,   
    2.2738094322	,   
    2.2699227333	,   
    2.26597166	,     
    2.26195597	,     
    2.25787639	,     
    2.25373315	,     
    2.24952674	,     
    2.24525714	,     
    2.24092483	,     
    2.2365305422	,   
    2.2320737833	,   
    2.2275557511	,   
    2.22297644	,     
    2.2183361	,       
    2.2136352	,       
    2.2088744644	,   
    2.2040534011	,   
    2.19917345	,     
    2.1942343711	,   
    2.18923664	,     
    2.18418073	,     
    2.1790671344	,   
    2.17389583	,     
    2.1686677933	,   
    2.163383	,       
    2.1580421922	,   
    2.15264558	,     
    2.14719367	,     
    2.14168667	,     
    2.13612532	,     
    2.1305098533	,   
    2.1248409744	,   
    2.11911869	,     
    2.1133439544	,   
    2.10751676	,     
    2.10163784	,     
    2.0957078933	,   
    2.08972668	,     
    2.0836951733	,   
    2.0776135922	,   
    2.07148265	,     
    2.06530261	,     
    2.05907392	,     
    2.05279731	,     
    2.0464732644	,   
    2.040102	,       
    2.0336842533	,   
    2.02722025	,     
    2.02071046	,     
    2.0141558644	,   
    2.00755691	,     
    2.0009133811	,   
    1.99422645	,     
    1.98749637	,     
    1.9807233811	,   
    1.9739086622	,   
    1.96705234	,     
    1.96015501	,     
    1.95321714	,     
    1.9462392333	,   
    1.93922185	,     
    1.93216526	,     
    1.9250705244	,   
    1.9179378744	,   
    1.9107680322	,   
    1.9035612344	,   
    1.89631807	,     
    1.88903892	,     
    1.88172471	,     
    1.87437594	,     
    1.86699295	,     
    1.8595764633	,   
    1.85212683	,     
    1.84464442	,     
    1.8371303	,       
    1.82958483	,     
    1.82200849	,     
    1.81440186	,     
    1.80676567	,     
    1.7991000411	,   
    1.79140544	,     
    1.7836830611	,   
    1.77593314	,     
    1.76815617	,     
    1.76035285	,     
    1.7525235411	,   
    1.74466931	,     
    1.7367897033	,   
    1.72888648	,     
    1.72095894	,     
    1.7130084033	,   
    1.7050359244	,   
    1.69704091	,     
    1.6890250444	,   
    1.6809878344	,   
    1.67293083	,     
    1.6648535722	,   
    1.65675699	,     
    1.64864254	,     
    1.64050948	,     
    1.6323595044	,   
    1.62419188	,     
    1.6160080433	,   
    1.60780894	,     
    1.59959387	,     
    1.59136486	,     
    1.5831210611	,   
    1.57486426	,     
    1.56659376	,     
    1.55831086	,     
    1.5500166411	,   
    1.54171037	,     
    1.53339398	,     
    1.52506733	,     
    1.5167309044	,   
    1.5083847044	,   
    1.5000299211	,   
    1.49166762	,     
    1.48329711	,     
    1.4749202722	,   
    1.4665364022	,   
    1.4581464522	,   
    1.4497519733	,   
    1.44135189	,     
    1.4329481122	,   
    1.4245399233	,   
    1.4161292311	,   
    1.4077150822	,   
    1.39929878	,     
    1.39088153	,     
    1.3824625011	,   
    1.3740434644	,   
    1.3656235933	,   
    1.3572049144	,   
    1.3487864733	,   
    1.3403694622	,   
    1.3319551944	,   
    1.3235425944	,   
    1.31513369	,     
    1.30672764	,     
    1.2983262533	,   
    1.28992927	,     
    1.28153669	,     
    1.2731502	,       
    1.26476895	,     
    1.2563948633	,   
    1.24802708	,     
    1.2396667	,       
    1.23131489	,     
    1.2229708433	,   
    1.21463632	,     
    1.2063103911	,   
    1.19799494	,     
    1.18968916	,     
    1.18139398	,     
    1.1731107233	,   
    1.1648384333	,   
    1.15657889	,     
    1.1483312844	,   
    1.1400966644	,   
    1.1318761111	,   
    1.12366867	,     
    1.11547637	,     
    1.10729801	,     
    1.09913551	,     
    1.09098804	,     
    1.08285653	,     
    1.07474219	,     
    1.06664455	,     
    1.0585643	,       
    1.0505011	,       
    1.0424565	,       
    1.03442978	,     
    1.0264220233	,   
    1.01843416	,     
    1.0104652644	,   
    1.0025171044	,   
    9.9458879233E-1	, 
    9.86681223E-1	,   
    9.78795468E-1	,   
    9.70930695E-1	,   
    9.6308839322E-1	, 
    9.55267787E-1	,   
    9.4747048611E-1	, 
    9.39695537E-1	,   
    9.3194389344E-1	, 
    9.24216628E-1	,   
    9.16512727E-1	,   
    9.0883386133E-1	, 
    9.0117907522E-1	, 
    8.93549978E-1	,   
    8.8594561811E-1	, 
    8.7836694711E-1	, 
    8.70814859E-1	,   
    8.63288521E-1	,   
    8.5578936333E-1	, 
    8.48317206E-1	,   
    8.40871632E-1	,   
    8.33454191E-1	,   
    8.2606399E-1	,   
    8.18702519E-1	,   
    8.11368823E-1	,   
    8.04064393E-1	,   
    7.9678827522E-1	, 
    7.89541483E-1	,   
    7.82324671E-1	,   
    7.75137066E-1	,   
    7.67979979E-1	,   
    7.60852635E-1	,   
    7.5375634433E-1	, 
    7.4669027322E-1	, 
    7.39655137E-1	,   
    7.32651829E-1	,   
    7.25679397E-1	,   
    7.18739152E-1	,   
    7.11830318E-1	,   
    7.0495361E-1	,   
    6.98109746E-1	,   
    6.9129794833E-1	, 
    6.8451935E-1	,   
    6.7777323722E-1	, 
    6.71060741E-1	,   
    6.64381086E-1	,   
    6.57735467E-1	,   
    6.51123523E-1	,   
    6.44544959E-1	,   
    6.38001024E-1	,   
    6.3149070733E-1	, 
    6.2501531833E-1	, 
    6.1857402322E-1	, 
    6.1216735833E-1	, 
    6.05796098E-1	,   
    5.9945935011E-1	, 
    5.93158245E-1	,   
    5.86891889E-1	,   
    5.80660998E-1	,   
    5.7446610922E-1	, 
    5.68306446E-1	,   
    5.6218302244E-1	, 
    5.56095063E-1	,   
    5.50043642E-1	,   
    5.4402780533E-1	, 
    5.3804826733E-1	, 
    5.3210550544E-1	, 
    5.2619868511E-1	, 
    5.2032887933E-1	, 
    5.14495253E-1	,   
    5.0869876144E-1	, 
    5.02938568E-1	,   
    4.97215271E-1	,   
    4.91529315E-1	,   
    4.8588034511E-1	, 
    4.80268418E-1	,   
    4.7469314933E-1	, 
    4.6915549033E-1	, 
    4.6365463733E-1	, 
    4.5819100733E-1	, 
    4.5276510711E-1	, 
    4.47376161E-1	,   
    4.42024976E-1	,   
    4.36710774E-1	,   
    4.3143403533E-1	, 
    4.26195144E-1	,   
    4.20993328E-1	,   
    4.1582939022E-1	, 
    4.1070255633E-1	, 
    4.05613631E-1	,   
    4.0056183933E-1	, 
    3.95547539E-1	,   
    3.9057114722E-1	, 
    3.8563188911E-1	, 
    3.8073048E-1	,   
    3.75866174E-1	,   
    3.7103971833E-1	, 
    3.6625030633E-1	, 
    3.61498326E-1	,   
    3.5678410533E-1	, 
    3.5210683944E-1	, 
    3.4746730322E-1	, 
    3.4286502E-1	,   
    3.3829960222E-1	, 
    3.3377176522E-1	, 
    3.2928070422E-1	, 
    3.24827104E-1	,   
    3.20410192E-1	,   
    3.16030591E-1	,   
    3.11687588E-1	,   
    3.0738142133E-1	, 
    3.0311241744E-1	, 
    2.9887977244E-1	, 
    2.94684112E-1	,   
    2.9052472111E-1	, 
    2.86402136E-1	,   
    2.82315641E-1	,   
    2.7826547622E-1	, 
    2.7425184844E-1	, 
    2.70274102E-1	,   
    2.66332686E-1	,   
    2.62426942E-1	,   
    2.5855708122E-1	, 
    2.5472325E-1	,   
    2.50924825E-1	,   
    2.47162237E-1	,   
    2.43434801E-1	,   
    2.3974299433E-1	, 
    2.36086145E-1	,   
    2.3246467111E-1	, 
    2.288782E-1	,     
    2.2532632944E-1	, 
    2.21809491E-1	,   
    2.18327E-1	,     
    2.1487928922E-1	, 
    2.11465686E-1	,   
    2.08086341E-1	,   
    2.04741373E-1	,   
    2.01430127E-1	,   
    1.9815297422E-1	, 
    1.9490928944E-1	, 
    1.91699177E-1	,   
    1.8852274111E-1	, 
    1.8537934122E-1	, 
    1.82269319E-1	,   
    1.7919206611E-1	, 
    1.76147893E-1	,   
    1.73136174E-1	,   
    1.7015701533E-1	, 
    1.67210489E-1	,   
    1.6429597133E-1	, 
    1.61413759E-1	,   
    1.5856327111E-1	, 
    1.5574477611E-1	, 
    1.52957677E-1	,   
    1.50202036E-1	,   
    1.4747791E-1	,   
    1.4478491244E-1	, 
    1.42122879E-1	,   
    1.39491453E-1	,   
    1.36890679E-1	,   
    1.34320572E-1	,   
    1.31780579E-1	,   
    1.29270941E-1	,   
    1.26791074E-1	,   
    1.24341204E-1	,   
    1.21920786E-1	,   
    1.19529835E-1	,   
    1.1716837433E-1	, 
    1.1483585E-1	,   
    1.12532466E-1	,   
    1.1025768511E-1	, 
    1.08011692E-1	,   
    1.0579396033E-1	, 
    1.03604503E-1	,   
    1.0144329811E-1	, 
    9.93098542E-2	,   
    9.72043126E-2	,   
    9.51261893E-2	,   
    9.30754616E-2	,   
    9.10521149E-2	,   
    8.90556722E-2	,   
    8.70862528E-2	,   
    8.5143387311E-2	, 
    8.32272023E-2	,   
    8.1337377422E-2	, 
    7.94735849E-2	,   
    7.7635951344E-2	, 
    7.5824014844E-2	, 
    7.40378946E-2	,   
    7.2277121244E-2	, 
    7.0541821422E-2	, 
    6.88315332E-2	,   
    6.71462416E-2	,   
    6.5485887222E-2	, 
    6.38500601E-2	,   
    6.22388348E-2	,   
    6.06517978E-2	,   
    5.90889118E-2	,   
    5.7550124822E-2	, 
    5.6035030633E-2	, 
    5.4543707511E-2	, 
    5.30757568E-2	,   
    5.16312457E-2	,   
    5.0209786744E-2	, 
    4.8811335111E-2	, 
    4.7435835E-2	,   
    4.60829176E-2	,   
    4.4752635E-2	,   
    4.34446223E-2	,   
    4.2158935211E-2	, 
    4.0895212444E-2	, 
    3.96535024E-2	,   
    3.8433555511E-2	, 
    3.7235129622E-2	, 
    3.6058265711E-2	, 
    3.4902632233E-2	, 
    3.37681733E-2	,   
    3.26548367E-2	,   
    3.15623059E-2	,   
    3.04906088E-2	,   
    2.94394418E-2	,   
    2.8408829122E-2	, 
    2.7398478233E-2	, 
    2.6408333333E-2	, 
    2.5438338511E-2	, 
    2.44882106E-2	,   
    2.35579721E-2	,   
    2.2647351022E-2	, 
    2.17563621E-2	,   
    2.0884744822E-2	, 
    2.00324487E-2	,   
    1.91994179E-2	,   
    1.83854065E-2	,   
    1.75904259E-2	,   
    1.68142374E-2	,   
    1.60567946E-2	,   
    1.53180454E-2	,   
    1.45977661E-2	,   
    1.38959651E-2	,   
    1.3212482444E-2	, 
    1.25472173E-2	,   
    1.1900022622E-2	, 
    1.12708537E-2	,   
    1.0659663E-2	,   
    1.0066265244E-2	, 
    9.4906622544E-3	, 
    8.93267802E-3	,   
    8.39231349E-3	,   
    7.86940287E-3	,   
    7.36390845E-3	,   
    6.87578925E-3	,   
    6.4048944044E-3	, 
    5.9512238944E-3	, 
    5.51463663E-3	,   
    5.09513262E-3	,   
    4.69258008E-3	,   
    4.30694921E-3	,   
    3.9382074022E-3	, 
    3.58623894E-3	,   
    3.2510426822E-3	, 
    2.9325131322E-3	, 
    2.63062631E-3	,   
    2.34535522E-3	,   
    2.0766099911E-3	, 
    1.8243892111E-3	, 
    1.5886131444E-3	, 
    1.3692802744E-3	, 
    1.16633623E-3	,   
    9.79734351E-4	,   
    8.09473393E-4	,   
    6.55499228E-4	,   
    5.1781081122E-4	, 
    3.9636433933E-4	, 
    2.91158881E-4	,   
    2.0216091E-4	,   
    1.29364751E-4	,   
    7.2762275522E-5	, 
    3.23354434E-5	,   
    8.08392815E-6	,   
    6.54251679E-15	, 

};
//------------------------- External variables --------------------------------------------------------
extern	EepromParaU__TypeDef	EepromPara;
//--------------------------local variables------------------------------------------------------------
IWR1443_Params_Trans__TypeDef IWR1443_Params_Trans;
VailEchoInformation__TypeDef VailEchoInformation[MAXVAILDECHONUMBERS];
VailEchoInformation__TypeDef VailEchoInformation_ST[MAXVAILDECHONUMBERS];
IWR1443_EchoInf__TypeDef VailEchoInformation_R[5];
Echo_para__TypeDef	VaildEchoInformationStock[WAVE_NUM_MAX];
IWR1443_ChipInf__TypeDef IWR1443_ChipInf[5];
IWR1443_ChipInf__TypeDef EchoInf_Weigh;

uint8_t	DistanceDownCount,DistanceUpCount;
uint8_t VaildEchoIndexQueue[16],Calib_Mode_IWR1443;
uint8_t BestWaveIndex,SecondWaveIndex;
uint8_t BestWaveIndex_Lcd;
uint8_t MarkBestWavePostion;
uint8_t DelayJudgeEcho,VaildEchoNumber,CalDistanceCount;
uint8_t UpdateCurveFlag,FakeCurveFlag;
uint16_t EchoCheckStart,EchoCheckEnd,MinDistinctivenessAD,ObjectChangSpeed;
uint16_t EchoMinValue,EchoMinWidth,CheckWindowLength;//,WaveMaxVarFalling;
uint16_t PreBestEchoPoint;
uint16_t Amplitude_Zoomout;
uint8_t CurrentEcho_Disappear_Count[3];
uint16_t CurrentEchoWeight;
uint16_t FEchoWeight;
float LCDCurveStart,LCDCurveEnd;
float SetFakeCurveStart,SetFakeCurveEnd;

uint16_t EchoBuffer_AV[SAMPLE_DATA_LENGTH];
uint16_t EchoBuffer_DV[SAMPLE_DATA_LENGTH];
uint16_t EchoBuffer[MAXFLITER_COUNT+1][SAMPLE_DATA_LENGTH];
uint16_t FakeWave[SAMPLE_DATA_LENGTH];
uint16_t CalLowSampleBuffer[SAMPLE_DATA_LENGTH];// @0x10004000;
uint32_t EchoAmplitude_Sum[SAMPLE_DATA_LENGTH] @0x10000004;

uint16_t FakeCoveValue;
uint8_t FakeCoveFlage;
uint8_t FlagOfChange_FakeWave;
uint8_t FakeWave_1443[LCDCURVE_LENGH];
uint8_t LcdEcho[LCDCURVE_LENGH];
uint8_t LcdReadFake_Count,Filter_Count;

float	DistanceBuffe[20];
uint8_t MaxVailEchoNumber,ForeVailEchoNumber;
uint16_t MaxThreshold_Int;
uint16_t ShockWave_MaxTH,ShockWave_MinTH;
float HighNoiseContiuing_Count;
uint8_t Set_MinNoise;
uint8_t EmptyCan_Wave_Count,EmptyCan_Area_Flag;
uint8_t EmptyCan_Wave_CountMax,EmptyCan_Handle_Flag;

JumpEchoInformation__TypeDef JumpEchoInfo_TempBuffer;
JumpEchoInformationUnion__TypeDef JumpEchoInfo_Buffer;
//uint8_t JumpEchoCurve[MAXRECORDJUMPCOUNT*2][IWR1443_WAVEDATA_LENGTH];
//uint8_t JumpEchoCurve_Buffer[IWR1443_WAVEDATA_LENGTH];
uint8_t RecordJump_Count;
uint8_t BetweenV_Count,UpperV_Count,LowerV_Count;
uint8_t JumpStatus;
float MaterialLevel_Speed;
float MaterialLevelJummp_Speed;

float OnePoint_M_Para;

uint8_t ZERO_TIMES;
uint8_t ADC_Total_Count;   
uint16_t Sample_Length_FFT;

float ADC_Minus_Data[FFT_NUMBER];
float FFTOutput_Float_Buffer[FFT_NUMBER/2];
float ADC_IW1443Data[1024];
//uint16_t FFT_AveOutput_Buffer[1024];
//-----------------------------------------------------------------------------------------------------
uint8_t	GetBestEchoIndex(void)
{
	return(BestWaveIndex_Lcd);
}

uint16_t GetDataSize_1443(void)
{
	return(IWR1443_Params_Trans.IWR1443_Params.baud_rate);
}

void	Set_IWR1443_CalibMode(uint16_t TempCalibMode)
{
	IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = TempCalibMode;
}

void	Init_26GEchoJudgeData(void)
{
	CheckWindowLength = ECHOMINWIDTH_26G/2;
	EchoMinWidth = ECHOMINWIDTH_26G;
	EchoMinValue = ECHOMINVALUE_26G;
//	WaveMaxVarFalling = 200;
//	CAL_SAMPLE_RATE_GAIN = 1;
	EchoMinValue = 1000;
//	WaveMaxVarFalling = 300;
	FakeCurveFlag = 6;
	LCDCurveEnd = EepromPara.EepromParaS.RangeValue.LowerRange+0.5;
	
	MaxVailEchoNumber = (uint8_t)EepromPara.EepromParaS.ExpandPara.CharPara[9]%10;
	ForeVailEchoNumber = (uint8_t)EepromPara.EepromParaS.ExpandPara.CharPara[9]/10;
	if((MaxVailEchoNumber > MAXVAILDECHONUMBERS)||(MaxVailEchoNumber <= 0))
	{
		MaxVailEchoNumber = 3;
	}
	if((ForeVailEchoNumber > MAXVAILDECHONUMBERS)||(ForeVailEchoNumber <= 0))
	{
		ForeVailEchoNumber = 3;
	}
	
	IWR1443_Params_Trans.IWR1443_Params.baud_rate = 1;/*波特率*/
	UpdateCurveFlag = 0;
	CurrentEcho_Disappear_Count[0] = (uint8_t)(EepromPara.EepromParaS.EchoAdjudgePara.ConfirmEchoTime);
	EmptyCan_Area_Flag = UNEMPFYCAN_AREA;
	Amplitude_Zoomout = 129;//TempMax/200;//;
	Calib_Mode_IWR1443 = EepromPara.EepromParaS.ExpandPara.CharPara[13]/10;
	if(Calib_Mode_IWR1443 == 0)
	{
		IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = ENABLE;
		IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = FULLCALIB_MODE;
	}
	
	Sample_Length_FFT = 512;
	ZERO_TIMES = 1;
}

void	ClearLowSampleBuffer(void)
{
	uint16_t TempI;
	for(TempI = 0; TempI < IWR1443_WAVEDATA_LENGTH; TempI++)
		LcdEcho[TempI] = 0;
}

uint16_t	GetBestEchoAmplitude(void)
{
	if(BestWaveIndex != BEST_WAVE_NOT_FIND)
	{
		if(IWR1443_Params_Trans.IWR1443_Params.baud_rate != 0)
			return(VailEchoInformation_ST[BestWaveIndex_Lcd].AmplitudeV);
		else //if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 0)
			return(VailEchoInformation[BestWaveIndex_Lcd].AmplitudeV);
	}
	else
	{
		return(0);
	}
}

uint16_t	GetBestEchoDistinctiveness(void)
{
	if(BestWaveIndex != BEST_WAVE_NOT_FIND)
	{
		return(VailEchoInformation_ST[BestWaveIndex_Lcd].EchoDistinctiveness);
	}
	else
	{
		return(0);
	}
}

uint8_t	GetMarkBestWavePostion(void)
{
	return(MarkBestWavePostion);
}

void	GetBestEchoInformation(VailEchoInformation__TypeDef TempVailEchoInfo[MAXVAILDECHONUMBERS])
{
//	uint32_t TempL;
//	uint16_t TempI;
	float TempF;
	if(BestWaveIndex_Lcd != BEST_WAVE_NOT_FIND)
	{
//		TempI = (uint16_t)(VailEchoInformation[BestWaveIndex].DistanceV*10);
		if((TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV > LCDCurveStart)&&(TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV < LCDCurveEnd))
		{
			TempF = TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV-LCDCurveStart;
			if(LCDCurveStart != LCDCurveEnd)
			{
				MarkBestWavePostion = (uint8_t)((TempF*100)/(LCDCurveEnd-LCDCurveStart)+1);
			}
			else
				MarkBestWavePostion = 0;
		}
		else
			MarkBestWavePostion = 0;
	}
	else
		MarkBestWavePostion = 0;
}

void	SetCurveStart_EndPoint(float TempLcdStart,float TempLcdEnd)
{
	UpdateCurveFlag = 1;
	if(TempLcdEnd > 0)
	{
		if(FakeCurveFlag == 0)
			FakeCurveFlag = 6;
		LCDCurveStart = TempLcdStart/GetUnitConv_Ratio();
		LCDCurveEnd = TempLcdEnd/GetUnitConv_Ratio();
		UpdateConfigIWR1443Para();
	}
}

void	UpdateLCDCurveData(void)
{
	uint8_t TempC;
	uint16_t tempy;
	uint16_t StartIndex,StartIndexX;
	uint16_t IndexX;
	float Zoomout_In_X;
	if(LCDCurveEnd == 0)
	{
		LCDCurveEnd = EepromPara.EepromParaS.RangeValue.LowerRange+0.5;
	}
	if(IWR1443_Params_Trans.IWR1443_Params.baud_rate != 0)
	{
		StartIndex = DistanceOutToPointIndexInt(LCDCurveStart);//(uint16_t)(LCDCurveStart/OnePoint_M_Para);
		StartIndexX = StartIndex;
		Zoomout_In_X = DistanceOutToPointIndexInt(LCDCurveEnd-LCDCurveStart);//(LCDCurveEnd-LCDCurveStart)/OnePoint_M_Para;
		Zoomout_In_X = Zoomout_In_X/LCDCURVE_LENGH;
		for(TempC = 0;TempC < LCDCURVE_LENGH; TempC++)
		{	
			IndexX = (uint16_t)(StartIndex+TempC*Zoomout_In_X);
			tempy = CalLowSampleBuffer[IndexX]/Amplitude_Zoomout;
			for(; StartIndexX <= IndexX; StartIndexX++)
			{
				if((CalLowSampleBuffer[StartIndexX]/Amplitude_Zoomout) > tempy)
					tempy = CalLowSampleBuffer[StartIndexX]/Amplitude_Zoomout;
				if(tempy > 255)
					tempy = 255;
				LcdEcho[TempC] = tempy;
			}
			if(StartIndexX > IndexX)
			{
				LcdEcho[TempC] = CalLowSampleBuffer[StartIndexX]/Amplitude_Zoomout;
			}
			StartIndexX = IndexX+1;
		}
	}
}
/*
void	ReadCurveData(uint8_t TempCurve[LCDCURVE_LENGH])
{
	uint8_t TempC;
	for(TempC = 0;TempC < LCDCURVE_LENGH; TempC++)
	{
		TempCurve[TempC] = LcdEcho[TempC];
	}
}
*/

void	DecipheringEncryption(uint8_t EncryptioneDData[])
{
	const uint8_t TempData[4] = {0x5A,0xA5,0xD5,0xBB};
	uint8_t TempBit_Index;
	uint8_t TempByte_Index;
	uint8_t TempShift;
	uint8_t EncryptioneDResult;
	for(TempByte_Index = 0; TempByte_Index < 4; TempByte_Index++)
	{
		TempShift = 0x80;
		EncryptioneDResult = 0;
		for(TempBit_Index = 0; TempBit_Index < 8; TempBit_Index++)
		{
			if((TempData[TempByte_Index]&TempShift) == 0)
			{
				EncryptioneDResult = EncryptioneDResult|(EncryptioneDData[TempByte_Index]&TempShift);
			}
			else
			{
				if((EncryptioneDData[TempByte_Index]&TempShift) ==0)
				{
					EncryptioneDResult = EncryptioneDResult|TempShift;
				}
				else
				{
					EncryptioneDResult = EncryptioneDResult&(~TempShift);
				}
			}
			TempShift >>= 1;
		}
		EncryptioneDData[TempByte_Index] = EncryptioneDResult;
	}
}
void	SetLcdLCDCurveEnd(float TempLCDCurveEnd)
{
	LCDCurveEnd = TempLCDCurveEnd;
}

void	UpdateConfigIWR1443Para(void)
{
	float TempF;
//	OnePoint_M_Para = ONE_PONIT_M_45;	
	IWR1443_Params_Trans.IWR1443_Params.fft_window_enable = EepromPara.EepromParaS.ExpandPara.CharPara[6]/10;
	IWR1443_Params_Trans.IWR1443_Params.code_window = EepromPara.EepromParaS.ExpandPara.CharPara[6]%10;
	IWR1443_Params_Trans.IWR1443_Params.adc_data_scale = EepromPara.EepromParaS.ExpandPara.CharPara[5]/10;/*adc数据右移位数*/
	IWR1443_Params_Trans.IWR1443_Params.fft_out_scale = 0;/*fft计算结果右移位数*/
	
	IWR1443_Params_Trans.IWR1443_Params.log_enable = EepromPara.EepromParaS.ExpandPara.CharPara[0]/10;
	IWR1443_Params_Trans.IWR1443_Params.fft_log = 1;
//	IWR1443_Params_Trans.IWR1443_Params.fft_log = EepromPara.EepromParaS.ExpandPara.CharPara[4]%10;
	IWR1443_Params_Trans.IWR1443_Params.rx_gain = EepromPara.EepromParaS.ExpandPara.CharPara[3];
	IWR1443_Params_Trans.IWR1443_Params.RF_Rx = EepromPara.EepromParaS.ExpandPara.CharPara[8]/10;
	IWR1443_Params_Trans.IWR1443_Params.RF_Tx = EepromPara.EepromParaS.ExpandPara.CharPara[8]%10;
	IWR1443_Params_Trans.IWR1443_Params.num_multi_chirp = EepromPara.EepromParaS.ExpandPara.CharPara[2];
	IWR1443_Params_Trans.IWR1443_Params.hpf1 = EepromPara.EepromParaS.ExpandPara.CharPara[7]/10;
	IWR1443_Params_Trans.IWR1443_Params.hpf2 = EepromPara.EepromParaS.ExpandPara.CharPara[7]%10;
	IWR1443_Params_Trans.IWR1443_Params.period_frame = EepromPara.EepromParaS.ExpandPara.CharPara[1];
	IWR1443_Params_Trans.IWR1443_Params.echo_bias_correct_enable = EepromPara.EepromParaS.ExpandPara.CharPara[10]/10;
	IWR1443_Params_Trans.IWR1443_Params.echo_bias_correct_code = EepromPara.EepromParaS.ExpandPara.CharPara[10]%10;
	IWR1443_Params_Trans.IWR1443_Params.fake_echo_filter_len = EepromPara.EepromParaS.ExpandPara.CharPara[13]%10;
	
	IWR1443_Params_Trans.IWR1443_Params.slope = EepromPara.EepromParaS.ExpandPara.FloatPara[6];//27.96
	IWR1443_Params_Trans.IWR1443_Params.slopeCorrection = EepromPara.EepromParaS.ExpandPara.FloatPara[11];//27.96
	IWR1443_Params_Trans.IWR1443_Params.diatanceExclution = EepromPara.EepromParaS.ExpandPara.FloatPara[12];//27.96
	if(EepromPara.EepromParaS.ExpandPara.FloatPara[7] > 77)
		IWR1443_Params_Trans.IWR1443_Params.start_freq = EepromPara.EepromParaS.ExpandPara.FloatPara[7];
	else
		IWR1443_Params_Trans.IWR1443_Params.start_freq = 77;
	
	IWR1443_Params_Trans.IWR1443_Params.display_start = (LCDCurveStart+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	if(LCDCurveEnd != 0)
	{
		IWR1443_Params_Trans.IWR1443_Params.display_end = (LCDCurveEnd+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	}
	else
	{
		IWR1443_Params_Trans.IWR1443_Params.display_end = EepromPara.EepromParaS.RangeValue.LowerRange;
	}
	if(LCDCurveEnd >= EepromPara.EepromParaS.RangeValue.LowerRange)
	{
		TempF = LCDCurveEnd;
	}
	else
	{
		TempF = EepromPara.EepromParaS.RangeValue.LowerRange;
	}
	if(TempF <= 1)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 1;
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 8;
	}
	else if(TempF <= 2)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 2;
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 8;
	}
	else if(TempF <= 4)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 3;/*量程编号*/
		ZERO_TIMES = 8;
	}
	else if(TempF <= 8)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 4;/*量程编号*/
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 4;
	}
	else if(TempF <= 16)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 5;/*量程编号*/
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 2;
	}
	else if(TempF <= 32)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 6;/*量程编号*/
		if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 2)
		{
			IWR1443_Params_Trans.IWR1443_Params.code_range = 7;/*量程编号*/
		}
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 4;
	}
	else if(TempF <= 64)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 7;/*量程编号*/
//		Sample_Length_FFT = 512;
		if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 2)
		{
			IWR1443_Params_Trans.IWR1443_Params.code_range = 8;/*量程编号*/
		}
		ZERO_TIMES = 4;
	}
	else if(TempF <= 128)
	{
		IWR1443_Params_Trans.IWR1443_Params.code_range = 8;/*量程编号*/
//		Sample_Length_FFT = 512;
		ZERO_TIMES = 2;
	}

	//	IWR1443_Params_Trans.IWR1443_Params.display_points = 100;
	IWR1443_Params_Trans.IWR1443_Params.detect_start = (EepromPara.EepromParaS.RangeLimit.UpperRange+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/
	  EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	IWR1443_Params_Trans.IWR1443_Params.detect_end = (EepromPara.EepromParaS.RangeLimit.LowerRange+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/
	  EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	IWR1443_Params_Trans.IWR1443_Params.Para_BackUp = FakeCurveFlag;
	if((IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 0)||(IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 6))
	{
		IWR1443_Params_Trans.IWR1443_Params.cur_pos_start = 0;
		IWR1443_Params_Trans.IWR1443_Params.cur_pos_end = EepromPara.EepromParaS.RangeValue.LowerRange+0.5;
		IWR1443_Params_Trans.IWR1443_Params.display_points = 100;		
	}
	else
	{
		IWR1443_Params_Trans.IWR1443_Params.cur_pos_start = (SetFakeCurveStart+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
		IWR1443_Params_Trans.IWR1443_Params.cur_pos_end = (SetFakeCurveEnd+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	}
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[4]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[8]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[12]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[16]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[24]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[28]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[40]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[44]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[52]);
	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[56]);
	
	IWR1443_Params_Trans.IWR1443_Params.code_algo = EepromPara.EepromParaS.BasicPara.DielectricConstant/10;
	if(IWR1443_Params_Trans.IWR1443_Params.code_algo == 1)
	{
		IWR1443_Params_Trans.IWR1443_Params.period_frame = 10;
		IWR1443_Params_Trans.IWR1443_Params.num_multi_chirp = 1;
		IWR1443_Params_Trans.IWR1443_Params.code_algo = 0;
	}
	else if(IWR1443_Params_Trans.IWR1443_Params.code_algo == 2)
	{
		IWR1443_Params_Trans.IWR1443_Params.period_frame = 40;
		IWR1443_Params_Trans.IWR1443_Params.num_multi_chirp = 31;
		IWR1443_Params_Trans.IWR1443_Params.code_algo = 1;
	}
	else
	{
		IWR1443_Params_Trans.IWR1443_Params.code_algo = EepromPara.EepromParaS.ExpandPara.CharPara[4]/10;/*算法编号*/
	}
	
	if(IWR1443_Params_Trans.IWR1443_Params.code_algo == 1)
	{
		OnePoint_M_Para = Solid_ONE_PONIT_M_Table[IWR1443_Params_Trans.IWR1443_Params.code_range-1];
	}
	else
	{
		OnePoint_M_Para = Liquid_ONE_PONIT_M_Table[IWR1443_Params_Trans.IWR1443_Params.code_range-1];
	}
	
	IWR1443_Params_Trans.IWR1443_Params.baud_rate = EepromPara.EepromParaS.ExpandPara.CharPara[4]%10;
	if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 2)
	{
		IWR1443_Params_Trans.IWR1443_Params.dump_adc = 1;
		OnePoint_M_Para = CpuFFT_ONE_PONIT_M_Table[IWR1443_Params_Trans.IWR1443_Params.code_range-1];
		if((IWR1443_Params_Trans.IWR1443_Params.code_range >= 7)&&(ZERO_TIMES == 4))
		{
			OnePoint_M_Para = CpuFFT_ONE_PONIT_M_Table[IWR1443_Params_Trans.IWR1443_Params.code_range-2];
		}
	}
	else
	{
		IWR1443_Params_Trans.IWR1443_Params.dump_adc = 0;
	}
	
	Calib_Mode_IWR1443 = EepromPara.EepromParaS.ExpandPara.CharPara[13]/10;
	switch(Calib_Mode_IWR1443)
	{
		case 0:
		break;
		case 1:
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = DISABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = FULLCALIB_MODE;
//			SetReceiveStartP(0);
		break;
		case 2:
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = ENABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = FULLCALIB_MODE;
//			SetReceiveStartP(0);
		break;
		case 3:
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = DISABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = PARTCALIB_MODE;
//			SetReceiveStartP(6);
		break;
		case 4:
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = ENABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = PARTCALIB_MODE;
//			SetReceiveStartP(6);
		break;
		default:
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = DISABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = FULLCALIB_MODE;
//			SetReceiveStartP(0);
		break;
	}
/*	if((IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash == ENABLE)||((FakeCurveFlag != 0)&&(FakeCurveFlag != 6)))
	{
		IWR1443_Params_Trans.IWR1443_Params.period_frame = 10;
		IWR1443_Params_Trans.IWR1443_Params.num_multi_chirp = 1;
		IWR1443_Params_Trans.IWR1443_Params.code_algo = 0;
	}*/
	IWR1443_Params_Trans.IWR1443_Params.dbg_level = EepromPara.EepromParaS.ExpandPara.CharPara[19]%10;
	IWR1443_Params_Trans.IWR1443_Params.nAvg = EepromPara.EepromParaS.ExpandPara.CharPara[5]%10;
	IWR1443_Params_Trans.IWR1443_Params.IWR_AWR_SW = EepromPara.EepromParaS.ExpandPara.CharPara[19]/10;
//	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[12]);
//	DecipheringEncryption(&IWR1443_Params_Trans.IWR1443_ParamsC[16]);
		
	IWR1443_Params_Trans.IWR1443_Params.CrcResult = HAL_CRC_Calculate(&hcrc,(uint32_t *)IWR1443_Params_Trans.IWR1443_ParamsC,sizeof(IWR1443_Params_Trans)-2);
	MaxVailEchoNumber = (uint8_t)EepromPara.EepromParaS.ExpandPara.CharPara[9]%10;
	ForeVailEchoNumber = (uint8_t)EepromPara.EepromParaS.ExpandPara.CharPara[9]/10;
	if((MaxVailEchoNumber > MAXVAILDECHONUMBERS)||(MaxVailEchoNumber <= 0))
	{
		MaxVailEchoNumber = 3;
	}
	if((ForeVailEchoNumber > MAXVAILDECHONUMBERS)||(ForeVailEchoNumber <= 0))
	{
		ForeVailEchoNumber = 3;
	}
	MaxThreshold_Int = EepromPara.EepromParaS.EchoAdjudgePara.Threshold*Amplitude_Zoomout;
	EmptyCan_Handle_Flag = EepromPara.EepromParaS.ExpandPara.CharPara[12]%10;
	EmptyCan_Wave_CountMax = EepromPara.EepromParaS.ExpandPara.CharPara[12]/10;
	Filter_Count = 0;
}

void	CreatFakeWavePointIndex(void)
{
	uint16_t i,TempI;
	uint16_t temp,TempMax;
	uint16_t TempFakeCurveStart,TempFakeCurveEnd;
	/* 虚假回波更改标志为无变化 */
	if(FlagOfChange_FakeWave == FAKE_CHANGE)
	{
		TempFakeCurveStart = DistanceOutToPointIndexInt(SetFakeCurveStart);
		TempFakeCurveEnd = DistanceOutToPointIndexInt(SetFakeCurveEnd);
		for(i = TempFakeCurveStart;i < TempFakeCurveEnd;i++) /* 虚假回波的起始采样点序号 到 终点采样点序号 */
		{
			if(i > IWR1443_Params_Trans.IWR1443_Params.fake_echo_filter_len)
			{
				temp = i-IWR1443_Params_Trans.IWR1443_Params.fake_echo_filter_len;
			}
			else
			{
				temp = 0;
			}
			
			TempI = i+IWR1443_Params_Trans.IWR1443_Params.fake_echo_filter_len;
			TempMax = CalLowSampleBuffer[temp];
			for(; temp < TempI; temp++)
			{
				if(TempMax < CalLowSampleBuffer[temp])
					TempMax = CalLowSampleBuffer[temp];
			}
			
//			if(FakeCurveFlag != 6)
				TempMax += FakeCoveValue;
//			else
//				TempMax += FakeEchoCove;
			
			if(TempMax > FAKEECHO_MAXVALURE)
			{
				TempMax = FAKEECHO_MAXVALURE;
			}
			FakeWave[i] = TempMax;
		}
		if(FakeCoveFlage == 1)/* 新建虚假回波时后面的部分置为固定值 */
		{
			for(i = TempFakeCurveEnd;i < SAMPLE_DATA_LENGTH;i++)
			{
				FakeWave[i]=10;
			}
		}
		FlagOfChange_FakeWave = FAKE_NO_CHANGE;
		SetSaveFakeInfo(ENABLE_WRITEEEPROM);
	}
}

void	CreatFakeCurve(float *TempF)
{
//	float TempFD;
	SetFakeCurveEnd = TempF[1]/GetUnitConv_Ratio();
	FakeCoveValue = EepromPara.EepromParaS.EchoAdjudgePara.FakeWaveGain*256;
	if(TempF[2] != 0)
	{
		FakeCurveFlag = 5;		//覆盖
		FakeCoveValue = (uint16_t)(TempF[2]*AMPLITUDE_COV_PARA_RF);
		SetFakeCurveStart = TempF[0]/GetUnitConv_Ratio();
	}
	else
	{
		if(TempF[0] <= 0.0008)
		{
			FakeCurveFlag = 1;
			SetFakeCurveStart = TempF[0]/GetUnitConv_Ratio();
		}
		else
		{
			FakeCurveFlag = 4;
			if(TempF[0] > 1000)
			{
				FakeCurveFlag = (uint8_t)(TempF[0]-1000);
				if(FakeCurveFlag == 3)
				{
					SetFakeCurveStart = SetFakeCurveEnd;
					SetFakeCurveEnd = EepromPara.EepromParaS.RangeValue.LowerRange;
				}
				else if((FakeCurveFlag == 1)||(FakeCurveFlag == 2))
				{
					SetFakeCurveStart = 0;//renew false wave 
				}
				else 
				{
					SetFakeCurveStart = TempF[0]/GetUnitConv_Ratio();
				}
			}
			else
			{
				SetFakeCurveStart = TempF[0]/GetUnitConv_Ratio();
			}
		}
	}
	if(IWR1443_Params_Trans.IWR1443_Params.baud_rate != 0)
	{//新建主CPU的虚假回波
		FakeCoveFlage = FakeCurveFlag;
		FlagOfChange_FakeWave = FAKE_CHANGE;
	}
	else
	{
		FakeWave_1443[98] = 0xA5;
		FakeWave_1443[99] = 0x5A;
	}
	IWR1443_Params_Trans.IWR1443_Params.display_points = FakeCoveValue;
	IWR1443_Params_Trans.IWR1443_Params.cur_pos_start = (SetFakeCurveStart+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	IWR1443_Params_Trans.IWR1443_Params.cur_pos_end = (SetFakeCurveEnd+EepromPara.EepromParaS.DistCoefficient.SystemZeroDist)/EepromPara.EepromParaS.DistCoefficient.SystemProportion;
	LcdReadFake_Count = 0;
	UpdateConfigIWR1443Para();
}

void	ParaConvert(void)
{
	UpdateConfigIWR1443Para();
	MinDistinctivenessAD = (uint16_t)(EepromPara.EepromParaS.EchoAdjudgePara.MinDistinctiveness*AMPLITUDE_COV_PARA_RF);
	EchoCheckStart = DistanceOutToPointIndexInt(EepromPara.EepromParaS.RangeLimit.UpperRange);
	EchoCheckEnd = DistanceOutToPointIndexInt(EepromPara.EepromParaS.RangeLimit.LowerRange);
	ObjectChangSpeed = DistanceOutToPointIndexInt(EepromPara.EepromParaS.BasicPara.OutputM_Speed);
	CurrentEchoWeight = (uint16_t)(EepromPara.EepromParaS.EchoAdjudgePara.CurrentEchoA*AMPLITUDE_COV_PARA_RF);
	FEchoWeight = (uint16_t)(EepromPara.EepromParaS.EchoAdjudgePara.FrontEchoA*AMPLITUDE_COV_PARA_RF);
	ShockWave_MaxTH = (uint16_t)(EepromPara.EepromParaS.ExpandPara.FloatPara[8]*AMPLITUDE_COV_PARA_RF);
	ShockWave_MinTH = (uint16_t)(EepromPara.EepromParaS.ExpandPara.FloatPara[9]*AMPLITUDE_COV_PARA_RF);
	Set_MinNoise = (uint8_t)(EepromPara.EepromParaS.ExpandPara.FloatPara[2]*AMPLITUDE_COV_PARA_LCD);
	MaxThreshold_Int = EepromPara.EepromParaS.EchoAdjudgePara.Threshold*Amplitude_Zoomout;
	if(Set_MinNoise > 250)
	{
		Set_MinNoise = 250;
	}
}

void	ConfirmValidEcho(void)
{
//	uint16_t TempI;
	if(VaildEchoInformationStock[VaildEchoNumber].end > VaildEchoInformationStock[VaildEchoNumber].start)
	{
		VaildEchoInformationStock[VaildEchoNumber].width = VaildEchoInformationStock[VaildEchoNumber].end-VaildEchoInformationStock[VaildEchoNumber].start;
	}
	else
	{
		VaildEchoInformationStock[VaildEchoNumber].width = 0;
	}
/*	if(VaildEchoInformationStock[VaildEchoNumber].max_value > MaxThreshold_Int)
		TempI = VaildEchoInformationStock[VaildEchoNumber].max_value - MaxThreshold_Int;
	else
		TempI = 0;
*/
	if((VaildEchoInformationStock[VaildEchoNumber].max_value > MaxThreshold_Int)&&(VaildEchoInformationStock[VaildEchoNumber].width >= EchoMinWidth))
	{
		if(VaildEchoInformationStock[VaildEchoNumber].max_value > VaildEchoInformationStock[VaildEchoNumber].min_value)
			VaildEchoInformationStock[VaildEchoNumber].Distinctiveness = VaildEchoInformationStock[VaildEchoNumber].max_value - VaildEchoInformationStock[VaildEchoNumber].min_value;
		else
			VaildEchoInformationStock[VaildEchoNumber].Distinctiveness = 0;
		if((VaildEchoInformationStock[VaildEchoNumber].Distinctiveness > MinDistinctivenessAD)&&(VaildEchoNumber < WAVE_NUM_MAX))
			VaildEchoNumber++;
	}
}

void	IndividualWaveCheckAllRange(uint16_t *buffer)
{
 	uint16_t TempInt,MaxCheckPoint;
	uint8_t edge = INIT_EDGE;
	uint8_t WindowCounter,FallingWindowCounter;
	uint16_t Temp_max_value_point;
	uint16_t Temp_max_value;
	uint16_t Temp_min_value_point;
	uint16_t Temp_min_value;
	
	FallingWindowCounter = 0;
	WindowCounter = 0;
	VaildEchoNumber = 0;
	if(EchoCheckStart < CheckWindowLength)
		EchoCheckStart = CheckWindowLength;
	VaildEchoInformationStock[0].start = 2;
	MaxCheckPoint = EchoCheckEnd;
	for(TempInt = 2;TempInt < EchoCheckEnd; TempInt++)//MaxCheckPoint = 255
	{
		if(edge == INIT_EDGE)
		{
			//确定初始的上升下降状态
			//上升趋势的确认
			//上升宽度确认
			//下降趋势的确认
			//下降宽度确认			
			if(buffer[TempInt] > buffer[TempInt+1])
			{
				FallingWindowCounter++;			
				if(FallingWindowCounter >= CheckWindowLength)//下降趋势宽度确认
				{
					edge = FALLING_EDGE; 
					FallingWindowCounter = 0; 
					VaildEchoInformationStock[VaildEchoNumber].max_value_point = 0;
					VaildEchoInformationStock[VaildEchoNumber].max_value = 0;
					Temp_min_value = 0xFFFF;
				}
				WindowCounter = 0;
			}
			else if(buffer[TempInt] < buffer[TempInt+1])
			{
				WindowCounter++;
				if(WindowCounter >= CheckWindowLength)
				{
					edge = RISING_EDGE;
					WindowCounter = 0;
					VaildEchoInformationStock[VaildEchoNumber].start = TempInt+1-CheckWindowLength;  //确认 first 波形的开始点
					VaildEchoInformationStock[VaildEchoNumber].min_value = buffer[VaildEchoInformationStock[VaildEchoNumber].start];
					Temp_max_value = 0;
				}
				FallingWindowCounter = 0; 
			}
		}
		else if(edge == RISING_EDGE)//check rising edge first,find out the maximum value,start point,end point,maximum point and minimum point
		{	//当前是上升状态
			if(buffer[TempInt] >= buffer[TempInt+1])
			{
				FallingWindowCounter++;//下降趋势确认
//				TempC = 0;
			}
			else
			{
			  	if (Temp_max_value < buffer[TempInt+1])
				{
					Temp_max_value = buffer[TempInt+1];
					Temp_max_value_point = TempInt+1;
				}
				FallingWindowCounter = 0;
			}
			if(FallingWindowCounter >= CheckWindowLength)//下降趋势宽度确认
			{
				edge = FALLING_EDGE; //更改当前状态为下降
				FallingWindowCounter = 0;
				Temp_min_value = buffer[TempInt+1];
				Temp_min_value_point = TempInt+1;
				if(Temp_max_value > buffer[TempInt+1-CheckWindowLength])
				{
					VaildEchoInformationStock[VaildEchoNumber].max_value_point = Temp_max_value_point;
					VaildEchoInformationStock[VaildEchoNumber].max_value = buffer[Temp_max_value_point];				      
				}
				else
				{
					VaildEchoInformationStock[VaildEchoNumber].max_value_point = TempInt+1-CheckWindowLength;  /* 确认最大值和最大值点 */
					VaildEchoInformationStock[VaildEchoNumber].max_value = buffer[TempInt+1-CheckWindowLength];
				}
			}
		}
		else if(edge == FALLING_EDGE)
		{	//当前是下降状态
			if(buffer[TempInt] <= buffer[TempInt+1])
			{
				WindowCounter++;  //上升趋势确认
			}
			else 
			{
			  	if (Temp_min_value > buffer[TempInt+1])
				{
				      	Temp_min_value = buffer[TempInt+1];
				      	Temp_min_value_point = TempInt+1;
				}
				WindowCounter=0;
			}
			if(WindowCounter >= CheckWindowLength)//上升趋势宽度确认
			{
				edge = RISING_EDGE;  //更改当前状态为上升
				WindowCounter=0;
				Temp_max_value = buffer[TempInt+1];
				Temp_max_value_point = TempInt+1;
				if(VaildEchoNumber < (WAVE_NUM_MAX-2))
				{
					if (Temp_min_value < buffer[TempInt+1-CheckWindowLength])
					{
						VaildEchoInformationStock[VaildEchoNumber].end = Temp_min_value_point;
						VaildEchoInformationStock[VaildEchoNumber].first = buffer[Temp_min_value_point];
						if(buffer[VaildEchoInformationStock[VaildEchoNumber].max_value_point] > FakeWave[VaildEchoInformationStock[VaildEchoNumber].max_value_point])
						{
							ConfirmValidEcho();				/* 确认有效回波 */
						}
						VaildEchoInformationStock[VaildEchoNumber].start = Temp_min_value_point;  //确认新波形的开始点
						VaildEchoInformationStock[VaildEchoNumber].min_value = buffer[Temp_min_value_point];
					}
					else
					{
						VaildEchoInformationStock[VaildEchoNumber].end=TempInt-CheckWindowLength+1;  /* 确认波形的结束点 */
						VaildEchoInformationStock[VaildEchoNumber].first=buffer[TempInt-CheckWindowLength+1];
						if(buffer[VaildEchoInformationStock[VaildEchoNumber].max_value_point] > FakeWave[VaildEchoInformationStock[VaildEchoNumber].max_value_point])
						{
							ConfirmValidEcho();				/* 确认有效回波 */
						}
						VaildEchoInformationStock[VaildEchoNumber].start=TempInt-CheckWindowLength+1;  //确认新波形的开始点
						VaildEchoInformationStock[VaildEchoNumber].min_value=buffer[TempInt-CheckWindowLength+1];
					}
				}  /* 一个完整的波形得到确认。*/
				else
					TempInt = MaxCheckPoint;
			}
			else
			{
				if(VaildEchoInformationStock[VaildEchoNumber].max_value < buffer[TempInt])
				{
					VaildEchoInformationStock[VaildEchoNumber].max_value = buffer[TempInt];
					VaildEchoInformationStock[VaildEchoNumber].max_value_point = TempInt;
				}
			}
		}
    }
 	if(edge == FALLING_EDGE)
	{
		VaildEchoInformationStock[VaildEchoNumber].end = EchoCheckEnd-1;
		if(buffer[VaildEchoInformationStock[VaildEchoNumber].max_value_point] > FakeWave[VaildEchoInformationStock[VaildEchoNumber].max_value_point])
		{
			ConfirmValidEcho();				//确认有效回波
		}
	}
}

void	VaildEcho_Analyse(void)
{
	uint8_t TempC;
	uint16_t TempMax,TempMin,TempI,TempM,TempD_value;
	
	TempMax = 0;
	for(TempC = 0; TempC < 16; TempC++)
	{
		VaildEchoIndexQueue[TempC] = BEST_WAVE_NOT_FIND;
	}
	for (TempI = 0; TempI < VaildEchoNumber; TempI++)
	{
		if(VaildEchoInformationStock[TempI].max_value > FakeWave[VaildEchoInformationStock[TempI].max_value_point])
			TempD_value = VaildEchoInformationStock[TempI].max_value-FakeWave[VaildEchoInformationStock[TempI].max_value_point];
		else
			TempD_value = 0;
		if(TempD_value > 1)		//与虚假回波幅值比较
		{
			if(VaildEchoInformationStock[TempI].max_value >= TempMax)
			{
				TempMax = VaildEchoInformationStock[TempI].max_value;
				for(TempC = 9; TempC > 0; TempC--)
				{
					VaildEchoIndexQueue[TempC] = VaildEchoIndexQueue[TempC-1];
				}
				VaildEchoIndexQueue[0] = TempI;
			}
			else
			{
				for(TempC = 0; TempC < 10; TempC++)
				{
					if(VaildEchoIndexQueue[TempC] != BEST_WAVE_NOT_FIND)
					{
						if(VaildEchoInformationStock[TempI].max_value > VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value)
						{
							for(TempM = 9; TempM > TempC; TempM--)
							{
								VaildEchoIndexQueue[TempM] = VaildEchoIndexQueue[TempM-1];
							}
							VaildEchoIndexQueue[TempC] = TempI;
							TempC = 10;
						}
					}
					else
					{
						VaildEchoIndexQueue[TempC] = TempI;
						TempC = 10;
					}
				}
			}
		}
//		else if(VaildEchoInformationStock[TempI].max_value_point < FreeNoiseEndPoint)
//		{
//			TempFakeW = TempD_value;		//刷新虚假回波
//		}
	}
	
	BestWaveIndex = VaildEchoIndexQueue[0];
	if(VaildEchoIndexQueue[0] != BEST_WAVE_NOT_FIND)
	{
		switch(EepromPara.EepromParaS.EchoAdjudgePara.EchoAdjudgeSEL)
		{
			case 0:
				if(VaildEchoIndexQueue[1] != BEST_WAVE_NOT_FIND)
				{
					if(EepromPara.EepromParaS.EchoAdjudgePara.FrontEchoA > 0)
					{
						TempMax = (unsigned int)(EepromPara.EepromParaS.EchoAdjudgePara.FrontEchoA*77.27);

						if(PreBestEchoPoint > VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value_point)
							TempI = PreBestEchoPoint - VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value_point;
						else
							TempI = VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value_point-PreBestEchoPoint;

						if(PreBestEchoPoint > VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value_point)
							TempMin = PreBestEchoPoint - VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value_point;
						else
							TempMin = VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value_point-PreBestEchoPoint;

						if((TempI < ObjectChangSpeed)||(TempMin < ObjectChangSpeed))
						{
							if(VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value > VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value)
								TempM = VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value - VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value;
							else
								TempM= VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value - VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value;
							if(TempI < TempMin)
							{
								BestWaveIndex = VaildEchoIndexQueue[0];
								if(VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value < VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value)
								{
									if(TempM > TempMax)
										BestWaveIndex = VaildEchoIndexQueue[1];
									SecondWaveIndex = VaildEchoIndexQueue[0];
								}
							}
							else
							{
								BestWaveIndex = VaildEchoIndexQueue[1];
								if(VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value < VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value)
								{
									if(TempM > TempMax)
										BestWaveIndex = VaildEchoIndexQueue[0];
									SecondWaveIndex = VaildEchoIndexQueue[1];
								}
							}
						}
						else
						{
							if(VaildEchoInformationStock[VaildEchoIndexQueue[1]].max_value > VaildEchoInformationStock[VaildEchoIndexQueue[0]].max_value)
								BestWaveIndex = VaildEchoIndexQueue[1];
							else
								BestWaveIndex = VaildEchoIndexQueue[0];
						}
					}
				}
				else
					BestWaveIndex = VaildEchoIndexQueue[0];
				break;
			case 1:
				TempC = 0;
				while(VaildEchoIndexQueue[TempC] != 0xFF)
				{
					if(BestWaveIndex > VaildEchoIndexQueue[TempC])
					{
						BestWaveIndex = VaildEchoIndexQueue[TempC]; 
					}
					TempC++;
					if(TempC == 3)
						break;
				}
				break;
			case 2:
			
				if(DelayJudgeEcho >= 88)
				{
					DelayJudgeEcho = 100;
					BestWaveIndex = BEST_WAVE_NOT_FIND;
					SecondWaveIndex = BEST_WAVE_NOT_FIND;
					TempM = 0xFF;
					TempMax = 0xFF;
					for(TempC = 0; TempC < 4; TempC++)
					{
						if(VaildEchoIndexQueue[TempC] != 0xFF)
						{
							if(PreBestEchoPoint > VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value_point)
								TempMin = PreBestEchoPoint - VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value_point;
							else
								TempMin = VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value_point - PreBestEchoPoint;
						
							if(TempMin < ObjectChangSpeed)
							{
							
								if(TempMin < TempMax)
								{
									SecondWaveIndex = BestWaveIndex;
									BestWaveIndex = VaildEchoIndexQueue[TempC];
									TempMax = TempMin;
								}
								else
								{
									if(TempMin < TempM)
									{
										SecondWaveIndex = VaildEchoIndexQueue[TempC];
										TempM = TempMin;										
									}
								}
							}
							if((BestWaveIndex != 0xFF)&&(SecondWaveIndex != 0xFF))
							{
								if(VaildEchoInformationStock[SecondWaveIndex].max_value > VaildEchoInformationStock[BestWaveIndex].max_value)
									BestWaveIndex = SecondWaveIndex;
							}
						}
					}
					if(BestWaveIndex == BEST_WAVE_NOT_FIND)
						BestWaveIndex = VaildEchoIndexQueue[0];
				}
		
				break;
			case 3:
				TempC = 0;
				TempMin = 0;
				while(VaildEchoIndexQueue[TempC] != BEST_WAVE_NOT_FIND)
				{
					TempMax = VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value-VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].min_value;
					if(TempMax > TempMin)
					{
						BestWaveIndex = VaildEchoIndexQueue[TempC];
						TempMin = TempMax;
					}
					TempC++;
					if(TempC == 4)
						break;
				}
				break;
			default:break;
		}
	}
}

//***********************************************************************************
//Function:DistCalc_MaxFallingDistMethod
//
//Description:This function calcs echo wave dist using a point which value is [VeryPointVar]
//                 below the max value.
//			
//
//Parameters:None
//
//Note:[VeryPointVar] is set as macro.
//       
//
//
//***********************************************************************************
uint16_t Test_max_value_point,Test1_max_value_point;
uint16_t Test_max_value;
float	DistCalc_MaxFallingDistMethod(uint8_t TempWaveIndex,uint16_t *SampleADVBuffer)
{
	float TampFloat,VeryPointVar,DistModify;
	uint16_t TempI,TempS,TempE,TempMaxV;//,TempMaxVPoint;
	
	Test_max_value_point = VaildEchoInformationStock[TempWaveIndex].max_value_point;
	if(VaildEchoInformationStock[TempWaveIndex].max_value_point > CALDISTANCEECHOWIDTH)
		TempS = VaildEchoInformationStock[TempWaveIndex].max_value_point-CALDISTANCEECHOWIDTH;
	else
		TempS = 0;
	TempE = VaildEchoInformationStock[TempWaveIndex].max_value_point+CALDISTANCEECHOWIDTH;
	TempMaxV = 0;
	for(TempI = TempS; TempI < TempE ;TempI++)
	{
		if(SampleADVBuffer[TempI] > TempMaxV)
		{
			TempMaxV = SampleADVBuffer[TempI];
			Test1_max_value_point = TempI;
		}
	}
	Test_max_value = TempMaxV;
	if(VaildEchoInformationStock[TempWaveIndex].max_value_point > EepromPara.EepromParaS.ExpandPara.CharPara[18])
	{
		TempS = VaildEchoInformationStock[TempWaveIndex].max_value_point-EepromPara.EepromParaS.ExpandPara.CharPara[18]+1;
		if(TempS > VaildEchoInformationStock[TempWaveIndex].start)
		{
			TempS = VaildEchoInformationStock[TempWaveIndex].start;
		}
	}
	else
		TempS = VaildEchoInformationStock[TempWaveIndex].start;
	VeryPointVar = TempMaxV-EepromPara.EepromParaS.ExpandPara.FloatPara[14];
	if(VeryPointVar < 0)
		VeryPointVar = 0;
	
	for(TempI = TempE; TempI > TempS ;TempI--)
	{
		if(( SampleADVBuffer[TempI] >= VeryPointVar )&&( SampleADVBuffer[TempI-1] <= VeryPointVar ))
		{
			if(SampleADVBuffer[TempI] != SampleADVBuffer[TempI-1])
				DistModify = OnePoint_M_Para*(SampleADVBuffer[TempI]-VeryPointVar)/(SampleADVBuffer[TempI]-SampleADVBuffer[TempI-1]);
			else
				DistModify = 0;

			TampFloat = (float)TempI;
			
			TampFloat = TampFloat*OnePoint_M_Para-DistModify;
			TempI = TempS;
			break;
		}
		else
		{
			TampFloat = (float)VaildEchoInformationStock[TempWaveIndex].max_value_point;
			TampFloat = TampFloat*OnePoint_M_Para;
		}
	}
	
	return TampFloat;
}

/*-------------------------------------------------------------------------------------------------------------------*/
/* 功能介绍: 
*      在找到的Wave_Stock.Wave_Num个回波中，对于回波最大值>最大值处采样点序号对应的虚假回波采样值+10的
*      回波认为是真正有效的回波，并对这些真正有效的回波按照回波最大值由大到小的顺序排列，并把对应的回波
*      序号放在VaildEcho[ ]中，即VaildEcho[0]对应回波最大值最大的回波的序号，VaildEcho[9对应回波最大值
*      最小的回波的序号，存储255代表没有找到回波
*/
void	ConfirmMaxValueWave_Num(void)
{
	uint8_t TempC,TempWave_Num;
	uint8_t TempRequeue;
	/* 将存放10个有效回波序号的数组VaildEcho[] 中的内容置为未找到 */
	for(TempC = 0; TempC < MAXVAILDECHONUMBERS; TempC++)
	{
		VaildEchoIndexQueue[TempC] = BEST_WAVE_NOT_FIND;
	}
	for (TempWave_Num = 0; TempWave_Num < VaildEchoNumber;TempWave_Num++)
	{
		//有效回波的序号按照回波幅值从大到小依次放在数组VaildEcho
		for(TempC = 0; TempC < MAXVAILDECHONUMBERS; TempC++)
		{
			if(VaildEchoIndexQueue[TempC] != BEST_WAVE_NOT_FIND)
			{
				if(VaildEchoInformationStock[TempWave_Num].max_value > VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value)
				{
					for(TempRequeue = (MAXVAILDECHONUMBERS-1); TempRequeue > TempC; TempRequeue--)
					{
						VaildEchoIndexQueue[TempRequeue] = VaildEchoIndexQueue[TempRequeue-1];
					}
					VaildEchoIndexQueue[TempC] = TempWave_Num;
					TempC = MAXVAILDECHONUMBERS;
				}
			}
			else
			{
				VaildEchoIndexQueue[TempC] = TempWave_Num;
				TempC = MAXVAILDECHONUMBERS;
			}
		}
	}
}

/*---------------------------------------------------------------------------------------------
计算各个回波距离位置，
*/
void	CalVaildEchoDistance(void)
{
	uint8_t TempC;
	float	TempDistance;
	for(TempC = 0; TempC < MaxVailEchoNumber; TempC++)
	{
		VailEchoInformation_ST[TempC].DistanceV = DISTANCEERROR;
		if(VaildEchoIndexQueue[TempC] != BEST_WAVE_NOT_FIND)
		{
			TempDistance = DistCalc_MaxFallingDistMethod(VaildEchoIndexQueue[TempC],CalLowSampleBuffer);
			if(TempDistance >= 0)
			{
				VailEchoInformation_ST[TempC].DistanceV = DistanceCalibration(TempDistance);
				VailEchoInformation_ST[TempC].AmplitudeV = VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value;
//				VailEchoInformation_ST[TempC].CurrentTime[0] = VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].max_value_point;
				VailEchoInformation_ST[TempC].EchoDistinctiveness = (uint8_t)(VaildEchoInformationStock[VaildEchoIndexQueue[TempC]].Distinctiveness/AMPLITUDE_COV_SAMPLE_255);
				VailEchoInformation_ST[TempC].EchoFeatures = '/';
			}
		}
		else
		{
			VailEchoInformation_ST[TempC].DistanceV = 0;
			VailEchoInformation_ST[TempC].AmplitudeV = 0;
			VailEchoInformation_ST[TempC].EchoFeatures = '/';
			VailEchoInformation_ST[TempC].EchoDistinctiveness = 0;
		}
	}
}

void	ClearIWR1443Data(void)
{
	uint16_t TempI;
	for(TempI = 0; TempI < EchoCheckEnd; TempI++)
	{
		EchoBuffer[0][TempI] = 0;
		CalLowSampleBuffer[TempI] = 0;
	}
}

uint8_t	GetShockWaveInf(void)
{
	return(BetweenV_Count);
}

void	HandleShockWave(uint16_t *LCDEchoData)
{
	uint8_t TempC,TempBetweenV_Count;
	if((EepromPara.EepromParaS.ExpandPara.CharPara[11]%10) == 1)
	{
		TempBetweenV_Count = 0;
		LowerV_Count = 0;
		UpperV_Count = 0;
		for(TempC = 0; TempC < IWR1443_WAVEDATA_LENGTH; TempC++)
		{
			if((LCDEchoData[TempC] < ShockWave_MaxTH)&&(LCDEchoData[TempC] > ShockWave_MinTH))
			{
				TempBetweenV_Count++;
			}
			else if(LCDEchoData[TempC] > ShockWave_MaxTH)
			{
				UpperV_Count++;
			}
			else if(LCDEchoData[TempC] < ShockWave_MinTH)
			{
				LowerV_Count++;
			}
		}
		if(TempBetweenV_Count > EepromPara.EepromParaS.ExpandPara.CharPara[16])
		{
			if(CalDistanceCount >= 1)
			{
				TempC = CalDistanceCount-1;
				DistanceBuffe[TempC] = EepromPara.EepromParaS.RangeValue.LowerRange;
			}
		}
		BetweenV_Count = TempBetweenV_Count;
	}
}

void	HandleEmpfyCan(float TempDistance)
{
	float TempF;
	if(EepromPara.EepromParaS.RangeValue.LowerRange > TempDistance)
	{
		TempF = EepromPara.EepromParaS.RangeValue.LowerRange-TempDistance;
	}
	else
	{
		TempF = 0;
	}
	
	if(EmptyCan_Area_Flag == EMPFYCAN_AREA)
	{//空罐状态
		if(TempF > EepromPara.EepromParaS.ExpandPara.FloatPara[3])//1m
		{//空罐状态，回波出现在超过离量程低位1m(设)
			BestWaveIndex = BEST_WAVE_NOT_FIND;
			EmptyCan_Wave_Count = 0;
		}
		else
		{
			if(TempF > EepromPara.EepromParaS.ExpandPara.FloatPara[4])
			{//空罐状态，回波出现在超过离量程低位0.5m(设)但是小于离量程低位1m(设)
				if(EmptyCan_Wave_Count < EmptyCan_Wave_CountMax)
					EmptyCan_Wave_Count = 0;
				if(EmptyCan_Wave_Count > (2*EmptyCan_Wave_CountMax))
				{
					EmptyCan_Area_Flag = UNEMPFYCAN_AREA;
					EmptyCan_Wave_Count = 0;
				}
			}
			else
			{//空罐状态，回波出现在低于离量程低位0.5m(设)
				if(EmptyCan_Wave_Count > EmptyCan_Wave_CountMax)
				{
					EmptyCan_Wave_Count = EmptyCan_Wave_CountMax+1;
				}
//				else
//				{
//					EmptyCan_Wave_Count++;
//				}
			}
		}
	}
	else
	{//非空罐状态
		if(TempF < EepromPara.EepromParaS.ExpandPara.FloatPara[4])
		{//非空罐状态，液位进入到离量程0.5m(设)
//			EmptyCan_Wave_Count++;
			if(EmptyCan_Wave_Count > EmptyCan_Wave_CountMax)
			{
				EmptyCan_Area_Flag = EMPFYCAN_AREA;
//				EmptyCan_Wave_Count = 0;
			}
		}
		else
		{
			EmptyCan_Wave_Count = 0;
		}
	}
}

void	VailEchoConfirm_IncTime(void)
{
//	VailEchoConfirm_Count++;
	EmptyCan_Wave_Count++;
	CurrentEcho_Disappear_Count[0]++;
//	CurrentEcho_Disappear_Count[1]++;
//	CurrentEcho_Disappear_Count[2]++;
}

void	ClearJumpCurveInfo(void)
{
	uint8_t TempC,TempJumpCurve_Index;
	for(TempJumpCurve_Index = 0; TempJumpCurve_Index < 10; TempJumpCurve_Index++)
	{
		for(TempC = 0; TempC < 100; TempC++)
		{
			JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].JumpEchoCurve[TempC] = 0;
		}
		JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].CurrentTime[0] = 0;
		JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].CurrentTime[1] = 0;
		for(TempC = 0; TempC < 5; TempC++)
		{
			JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].JumpEchoInfo[TempC].DistanceV = 0;
			JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].JumpEchoInfo[TempC].AmplitudeV = 0;
			JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].JumpEchoInfo[TempC].EchoFeatures = 0;
			JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempJumpCurve_Index].JumpEchoInfo[TempC].EchoDistinctiveness = 0;
		}
	}
	RecordJump_Count = 0;
}

void	ReadJumpCurveInfo_485(uint8_t *JumpCuveInfo,uint16_t JumpCuveInfo_StartA,uint16_t JumpCuveInfo_ByteNum)
{
//	uint8_t TempC;
	uint16_t Temp_Index,TempI;	
	uint8_t ReadJumpCurve_Index;
	union 
	{
		uint8_t CharTime[8];
		float TempTime[2];
	}PrecurrentTime;
	
	Temp_Index = JumpCuveInfo_StartA*2;
	TempI = Temp_Index+JumpCuveInfo_ByteNum;
	GetMeterCurrentTime(PrecurrentTime.TempTime);
	
	for(; Temp_Index < TempI; Temp_Index++)
	{
		if((Temp_Index%148) == 100)
		{
			ReadJumpCurve_Index = Temp_Index/148;
			if(PrecurrentTime.TempTime[0] < JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0])
			{
				if(PrecurrentTime.TempTime[1] >= 1)
				{
					PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-1;
					PrecurrentTime.TempTime[0] = 100000-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0]+PrecurrentTime.TempTime[0];
					PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1];
				}
				else
				{
					PrecurrentTime.TempTime[0] = 0;
					PrecurrentTime.TempTime[1] = 0;
				}
			}
			else if(JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1] <= PrecurrentTime.TempTime[1])
			{
				PrecurrentTime.TempTime[0] = PrecurrentTime.TempTime[0]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0];
				PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1];
			}
			else
			{
				PrecurrentTime.TempTime[0] = 0;
				PrecurrentTime.TempTime[1] = 0;
			}
		}
		
		ReadJumpCurve_Index = Temp_Index%148;
		if((ReadJumpCurve_Index < 100)||(ReadJumpCurve_Index > 107))
		{
			JumpCuveInfo[Temp_Index-JumpCuveInfo_StartA*2] = JumpEchoInfo_Buffer.JumpEchoInfoC[Temp_Index];
		}
		else if((ReadJumpCurve_Index >= 100)&&(ReadJumpCurve_Index <= 107))
		{			
			JumpCuveInfo[Temp_Index-JumpCuveInfo_StartA*2] = PrecurrentTime.CharTime[ReadJumpCurve_Index-100];
		}
	}
}

void	ReadJumpCurveInfo(uint8_t *JumpCuveInfo,uint8_t JumpCuveInfo_Index)
{
	uint8_t TempC;
	uint8_t Temp_Index;	
	uint8_t ReadJumpCurve_Index;
	union 
	{
		uint8_t CharTime[8];
		float TempTime[2];
	}PrecurrentTime;
	Temp_Index = JumpCuveInfo_Index%8;
	ReadJumpCurve_Index = JumpCuveInfo_Index/8;
	if(ReadJumpCurve_Index > (MAXRECORDJUMPCOUNT*2))
	{
		ReadJumpCurve_Index = 0;
	}
	if(Temp_Index < 2)
	{
		for(TempC = 0; TempC < 50; TempC++)
		{
			JumpCuveInfo[TempC] = JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].JumpEchoCurve[TempC+Temp_Index*50];
		}
	}
	else if(Temp_Index >= 2)
	{
		if(Temp_Index == 2)
		{
			GetMeterCurrentTime(PrecurrentTime.TempTime);
			if(PrecurrentTime.TempTime[0] < JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0])
			{
				if(PrecurrentTime.TempTime[1] >= 1)
				{
					PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-1;
					PrecurrentTime.TempTime[0] = 100000-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0]+PrecurrentTime.TempTime[0];
					PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1];
				}
				else
				{
					PrecurrentTime.TempTime[0] = 0;
					PrecurrentTime.TempTime[1] = 0;
				}
			}
			else if(JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1] <= PrecurrentTime.TempTime[1])
			{
				PrecurrentTime.TempTime[0] = PrecurrentTime.TempTime[0]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[0];
				PrecurrentTime.TempTime[1] = PrecurrentTime.TempTime[1]-JumpEchoInfo_Buffer.JumpEchoInfoStruct[ReadJumpCurve_Index].CurrentTime[1];
			}
			else
			{
				PrecurrentTime.TempTime[0] = 0;
				PrecurrentTime.TempTime[1] = 0;
			}
			
			for(TempC = 0; TempC < 8; TempC++)
			{
				JumpCuveInfo[TempC] = PrecurrentTime.CharTime[TempC];
			}		
			for(TempC = 8; TempC < 48; TempC++)
			{
				JumpCuveInfo[TempC] = JumpEchoInfo_Buffer.JumpEchoInfoC[ReadJumpCurve_Index*148+100+TempC+(Temp_Index-2)*50];
			}		
		}
	}
}

void	SetJumpEchoInfoP(float Fram_JumpEcho_Index)
{
	RecordJump_Count = (uint8_t)(Fram_JumpEcho_Index);
	if(RecordJump_Count >= MAXRECORDJUMPCOUNT)
	{
		RecordJump_Count = 0;
	}
	RecordRealPerfToFRAM(RecordJump_Count,RECORD_JUMP_INDEX);		
}

void	RecordJumpEchoInfor(VailEchoInformation__TypeDef TempVailEchoInfo[MAXVAILDECHONUMBERS])
{
	float TempDistanceDV;
	uint8_t TempC,TempCount;
//	if(BestWaveIndex < 5)
///	{
		for(TempC = 0; TempC < 5; TempC++)
		{
//			TempVailEchoInfo[TempC].EchoFeatures = 0x2F;
			if((uint16_t)(EchoInf_Weigh.DistanceV[BestWaveIndex_Lcd]*1000) == (uint16_t)(TempVailEchoInfo[TempC].DistanceV*1000))
			{
				TempVailEchoInfo[TempC].EchoFeatures = 0x3E;
				BestWaveIndex_Lcd = TempC;
				TempC = 0x5A;
			}
		}
//	}
	
	if(TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV > 0)//&&(FakeCurveFlag == 0))
	{
		/*计算前后两次的测量距离差值*/
		MaterialLevelJummp_Speed = EepromPara.EepromParaS.JumpPara.JumpDist;//GetIWR1443WorkPeriod()*
		if(TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV > GetPreOneSecondEvenValure())
		{
			TempDistanceDV = TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV-GetPreOneSecondEvenValure();
		}
		else
		{
			TempDistanceDV = GetPreOneSecondEvenValure()-TempVailEchoInfo[BestWaveIndex_Lcd].DistanceV;
		}
		if(TempDistanceDV > MaterialLevelJummp_Speed)
		{
			if(JumpStatus == ECHOCONFIRM)
			{//判断前后两次测量值的差值有没有超过设定的跳变距离，如果超过了就把这两次的曲线信息存储起来
				TempCount = RecordJump_Count*2;//每一次记录两条曲线（跳变前和跳变后）
				for(TempC = 0; TempC < IWR1443_WAVEDATA_LENGTH; TempC++)
				{
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].JumpEchoCurve[TempC] = LcdEcho[TempC];//跳变后				
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].JumpEchoCurve[TempC] = JumpEchoInfo_TempBuffer.JumpEchoCurve[TempC];//跳变前
				}
				for(TempC = 0; TempC < 5; TempC++)
				{
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].JumpEchoInfo[TempC].DistanceV = JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].DistanceV;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].JumpEchoInfo[TempC].AmplitudeV = JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].AmplitudeV;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].JumpEchoInfo[TempC].EchoFeatures = JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].EchoFeatures;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].JumpEchoInfo[TempC].EchoDistinctiveness = JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].EchoDistinctiveness;

					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].JumpEchoInfo[TempC].DistanceV = TempVailEchoInfo[TempC].DistanceV;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].JumpEchoInfo[TempC].AmplitudeV = TempVailEchoInfo[TempC].AmplitudeV;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].JumpEchoInfo[TempC].EchoFeatures = TempVailEchoInfo[TempC].EchoFeatures;
					JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].JumpEchoInfo[TempC].EchoDistinctiveness = TempVailEchoInfo[TempC].EchoDistinctiveness;
				}
				JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].CurrentTime[0] = JumpEchoInfo_TempBuffer.CurrentTime[0];
				JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount].CurrentTime[1] = JumpEchoInfo_TempBuffer.CurrentTime[1];
				GetMeterCurrentTime(JumpEchoInfo_Buffer.JumpEchoInfoStruct[TempCount+1].CurrentTime);
				RecordJump_Count++;
				if(RecordJump_Count >= MAXRECORDJUMPCOUNT)
				{
					RecordJump_Count = 0;
				}
				JumpStatus = JUMPEND;
			}
		}
		else if(CurrentEcho_Disappear_Count[0] == 0)/*更新跳变前的回波距离和幅值*/
		{//记录确认新回波前的曲线
		
			for(TempC = 0; TempC < IWR1443_WAVEDATA_LENGTH; TempC++)
			{
				JumpEchoInfo_TempBuffer.JumpEchoCurve[TempC] = LcdEcho[TempC];				
			}
			for(TempC = 0; TempC < 5; TempC++)
			{
				JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].DistanceV = TempVailEchoInfo[TempC].DistanceV;
				JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].AmplitudeV = TempVailEchoInfo[TempC].AmplitudeV;
				JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].EchoFeatures = TempVailEchoInfo[TempC].EchoFeatures;
				JumpEchoInfo_TempBuffer.JumpEchoInfo[TempC].EchoDistinctiveness = TempVailEchoInfo[TempC].EchoDistinctiveness;
			}
			GetMeterCurrentTime(JumpEchoInfo_TempBuffer.CurrentTime);
			JumpStatus = DISTANCECONFIRM;
		}
	}
}

void	HandleFluctuate(void)
{
	uint8_t TempC;
	uint16_t TempI;
	if((EepromPara.EepromParaS.ExpandPara.CharPara[17]%10) == 1)
	{
		for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
		{
			EchoBuffer_DV[TempI] = 0;
		}
	
		for(TempC = 0; TempC < EepromPara.EepromParaS.ExpandPara.CharPara[14]; TempC++)
		{
			for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
			{
				if(EchoBuffer[TempC][TempI] > EchoBuffer[TempC+1][TempI])
				{
					EchoBuffer_DV[TempI] = EchoBuffer[TempC][TempI]-EchoBuffer[TempC+1][TempI]+EchoBuffer_DV[TempI];
				}
				else
				{
					EchoBuffer_DV[TempI] = EchoBuffer[TempC+1][TempI]-EchoBuffer[TempC][TempI]+EchoBuffer_DV[TempI];
				}
			}
		}
		TempC = EepromPara.EepromParaS.ExpandPara.CharPara[17]/10;
		for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
		{
			EchoBuffer_AV[TempI] = EchoBuffer_DV[TempI]/EepromPara.EepromParaS.ExpandPara.CharPara[14];
			EchoBuffer_DV[TempI] = EchoBuffer_DV[TempI]-EchoBuffer_AV[TempI];
			if(TempC == 1)
			{
				CalLowSampleBuffer[TempI] = EchoBuffer_DV[TempI];
			}
			else if(TempC == 2)
			{
				CalLowSampleBuffer[TempI] = CalLowSampleBuffer[TempI]+EchoBuffer_DV[TempI];
			}
		}
	}
}

void	HandleEchoSuccession(VailEchoInformation__TypeDef *TempVailEchoInformation)
{
	float TempF,MinD_Value;
	uint8_t TempC,TempD;
	for(TempC = 0; TempC < 5; TempC++)
	{
		VailEchoInformation_R[0].AmplitudeV[TempC] = TempVailEchoInformation[TempC].AmplitudeV;
	}
	
	//判断连续性
	for(TempD = 0; TempD < 5; TempD++)
	{
		MinD_Value = 999999;
		for(TempC = 0; TempC < 5; TempC++)
		{
			if(TempVailEchoInformation[TempD].DistanceV > VailEchoInformation_R[0].DistanceV[TempC])
			{
				TempF = TempVailEchoInformation[TempD].DistanceV-VailEchoInformation_R[0].DistanceV[TempC];
			}
			else
			{
				TempF = VailEchoInformation_R[0].DistanceV[TempC]-TempVailEchoInformation[TempD].DistanceV;
			}
		
			if(TempF < MinD_Value)
			{
				MinD_Value = TempF;
			}
		}
	}
	
	for(TempC = 0; TempC < 5; TempC++)
	{
		VailEchoInformation_R[0].AmplitudeV[TempC] = TempVailEchoInformation[TempC].AmplitudeV;
		VailEchoInformation_R[0].DistanceV[TempC] = TempVailEchoInformation[TempC].DistanceV;
		VailEchoInformation_R[0].EchoDistinctiveness[TempC] = TempVailEchoInformation[TempC].EchoDistinctiveness;
	}
	
}

void	HandleJudgmentEcho(uint8_t VaildEchoRang,uint8_t VailEchoNumber,VailEchoInformation__TypeDef *TempVailEchoInformation)
{
	uint8_t TempC,TempIndex;
	uint16_t TempMaxAmplitude;
	float TempStandardDistance;
	float TempDistanceDV; 
	float MinDistanceV;
	TempIndex = 0;
	TempStandardDistance = GetPreOneSecondEvenValure();
	for(TempC = 0; TempC < VailEchoNumber; TempC++)
	{
		if(TempVailEchoInformation[TempC].DistanceV != DISTANCEERROR)
		{
			if(TempStandardDistance > TempVailEchoInformation[TempC].DistanceV)
			{//与上一次回波距离进行比较
				TempDistanceDV = TempStandardDistance-TempVailEchoInformation[TempC].DistanceV;
			}
			else
			{
				TempDistanceDV = TempVailEchoInformation[TempC].DistanceV-TempStandardDistance;
			}
			
			if(VaildEchoRang == 1)
			{//非连续范围里加上跟随优势
				if(TempDistanceDV < MaterialLevel_Speed)
				{
					EchoInf_Weigh.AmplitudeV[TempIndex] = TempVailEchoInformation[TempC].AmplitudeV+CurrentEchoWeight;
					EchoInf_Weigh.DistanceV[TempIndex] = TempVailEchoInformation[TempC].DistanceV;
				}
				else
				{
					EchoInf_Weigh.AmplitudeV[TempIndex] = TempVailEchoInformation[TempC].AmplitudeV;
					EchoInf_Weigh.DistanceV[TempIndex] = TempVailEchoInformation[TempC].DistanceV;
				}
				VaildEchoIndexQueue[TempIndex] = TempIndex;
				TempIndex++;
			}
			else if(TempDistanceDV < EepromPara.EepromParaS.ExpandPara.FloatPara[10])
			{//在连续范围里的回波加上跟随优势					
				if(TempDistanceDV < MaterialLevel_Speed)
				{
					EchoInf_Weigh.AmplitudeV[TempIndex] = TempVailEchoInformation[TempC].AmplitudeV+CurrentEchoWeight;
					EchoInf_Weigh.DistanceV[TempIndex] = TempVailEchoInformation[TempC].DistanceV;
				}
				else
				{
					EchoInf_Weigh.AmplitudeV[TempIndex] = TempVailEchoInformation[TempC].AmplitudeV;
					EchoInf_Weigh.DistanceV[TempIndex] = TempVailEchoInformation[TempC].DistanceV;
				}
				VaildEchoIndexQueue[TempIndex] = TempIndex;
				TempIndex++;
			}
		}
	}
			
	for(TempIndex = 0; TempIndex < VailEchoNumber; TempIndex++)
	{
		TempMaxAmplitude = 0;
		for(TempC = TempIndex; TempC < VailEchoNumber; TempC++)
		{
			if(VaildEchoIndexQueue[TempC] != BEST_WAVE_NOT_FIND)
			{
				if(EchoInf_Weigh.AmplitudeV[VaildEchoIndexQueue[TempC]] > TempMaxAmplitude)
				{
					SecondWaveIndex = TempC;
					TempMaxAmplitude = EchoInf_Weigh.AmplitudeV[VaildEchoIndexQueue[TempC]];
				}
			}
			else
			{
				TempC = 0x5A;
			}
		}
		if(VaildEchoIndexQueue[TempIndex] == BEST_WAVE_NOT_FIND)
		{
			TempIndex = 0x5A;
		}
		else
		{
			TempC = VaildEchoIndexQueue[TempIndex];
			VaildEchoIndexQueue[TempIndex] = VaildEchoIndexQueue[SecondWaveIndex];
			VaildEchoIndexQueue[SecondWaveIndex] = TempC;			
		}
	}
		MinDistanceV = 88888;
		for(TempIndex = 0; TempIndex < ForeVailEchoNumber; TempIndex++)
		{
			if(VaildEchoIndexQueue[TempIndex] != BEST_WAVE_NOT_FIND)
			{
				if(EchoInf_Weigh.DistanceV[VaildEchoIndexQueue[TempIndex]] < MinDistanceV)
				{
					MinDistanceV = EchoInf_Weigh.DistanceV[VaildEchoIndexQueue[TempIndex]];
					BestWaveIndex = VaildEchoIndexQueue[TempIndex];
				}
			}
			else
			{
				TempIndex = 0x5A;
			}
		}

		if(EepromPara.EepromParaS.EchoAdjudgePara.EchoAdjudgeSEL == 0)
		{//最大优先
			if(BestWaveIndex != BEST_WAVE_NOT_FIND)
			{
				EchoInf_Weigh.AmplitudeV[BestWaveIndex] = EchoInf_Weigh.AmplitudeV[BestWaveIndex]+FEchoWeight;
			}
			TempMaxAmplitude = 0;
			for(TempC = 0; TempC < VailEchoNumber; TempC++)
			{
				if(EchoInf_Weigh.AmplitudeV[TempC] > TempMaxAmplitude)
				{
					TempMaxAmplitude = EchoInf_Weigh.AmplitudeV[TempC];
					BestWaveIndex = TempC;
				}
			}
		}
		else if(EepromPara.EepromParaS.EchoAdjudgePara.EchoAdjudgeSEL == 3)
		{
		MinDistanceV = 0;
		for(TempIndex = 0; TempIndex < VailEchoNumber; TempIndex++)
		{
			if(VaildEchoIndexQueue[TempIndex] != BEST_WAVE_NOT_FIND)
			{
				if(TempVailEchoInformation[VaildEchoIndexQueue[TempIndex]].EchoDistinctiveness > MinDistanceV)
				{
					MinDistanceV = TempVailEchoInformation[VaildEchoIndexQueue[TempIndex]].EchoDistinctiveness;
					BestWaveIndex = VaildEchoIndexQueue[TempIndex];
				}
			}
			else
			{
				TempIndex = 0x5A;
			}
		}
		}
		else if(EepromPara.EepromParaS.EchoAdjudgePara.EchoAdjudgeSEL == 2)
		{
			//HandleEchoSuccession(TempVailEchoInformation);
		}
}

uint8_t	HandleMaxPriority(uint8_t *TempCurrentEcho_Disappear_Count,uint8_t VailEchoNumber,VailEchoInformation__TypeDef *TempVailEchoInformation,float  StandardDistance)
{
	uint8_t TempC;
	float TempDistanceDV; 
	MaterialLevel_Speed = EepromPara.EepromParaS.BasicPara.OutputM_Speed;//GetIWR1443WorkPeriod()*
//	TempForemostEcho_OrderNum = BEST_WAVE_NOT_FIND;
//	TempCurrentEcho_OrderNum = BEST_WAVE_NOT_FIND;
	SecondWaveIndex = BEST_WAVE_NOT_FIND;
	BestWaveIndex = BEST_WAVE_NOT_FIND;
	
	for(TempC = 0; TempC < 16; TempC++)
	{
		VaildEchoIndexQueue[TempC] = BEST_WAVE_NOT_FIND;
	}
	
		for(TempC = 0; TempC < VailEchoNumber; TempC++)
		{
			EchoInf_Weigh.AmplitudeV[TempC] = 0;
			EchoInf_Weigh.DistanceV[TempC] = -1;
			if((TempVailEchoInformation[TempC].DistanceV > EepromPara.EepromParaS.RangeLimit.LowerRange)
		 	  ||(TempVailEchoInformation[TempC].DistanceV < EepromPara.EepromParaS.RangeLimit.UpperRange))
			{
				TempVailEchoInformation[TempC].AmplitudeV = 0;
				TempVailEchoInformation[TempC].DistanceV = DISTANCEERROR;
			}
		
			if( MaxThreshold_Int > TempVailEchoInformation[TempC].AmplitudeV)
			{
				TempVailEchoInformation[TempC].AmplitudeV = 0;
				TempVailEchoInformation[TempC].DistanceV = DISTANCEERROR;
			}
		}
				
		if((EepromPara.EepromParaS.ExpandPara.CharPara[11]/10) == 1)
		{
			HandleJudgmentEcho(0,VailEchoNumber,TempVailEchoInformation);
		}
	
	if(BestWaveIndex == BEST_WAVE_NOT_FIND)
	{
		HandleJudgmentEcho(1,VailEchoNumber,TempVailEchoInformation);		
	}
	
	if(BestWaveIndex != BEST_WAVE_NOT_FIND)
	{
		if(StandardDistance > EchoInf_Weigh.DistanceV[BestWaveIndex])
		{//与上一次回波距离进行比较
			TempDistanceDV = StandardDistance-EchoInf_Weigh.DistanceV[BestWaveIndex];
		}
		else
		{
			TempDistanceDV = EchoInf_Weigh.DistanceV[BestWaveIndex]-StandardDistance;
		}
		if(TempDistanceDV > MaterialLevel_Speed)
		{//最优回波速度超过了设定物位速度，等到回波确认时间达到后才作为真实料位输出
			if((*TempCurrentEcho_Disappear_Count) < EepromPara.EepromParaS.EchoAdjudgePara.ConfirmEchoTime)
			{//回波确认时间还没有到，作为失波处理
				BestWaveIndex = BEST_WAVE_NOT_FIND;
				SetMeterOutStatus(METEROUTSTATUS_B);
			}
			else
			{
				if(JumpStatus == DISTANCECONFIRM)
				{
					JumpStatus = ECHOCONFIRM;
				}
			}
		}
		else
		{//最优回波速度没有超过设定物位速度，直接作为真实料位输出
			(*TempCurrentEcho_Disappear_Count) = 0;
			SetMeterOutStatus(0);
		}
		
		if((EmptyCan_Handle_Flag == ENABLE)&&(BestWaveIndex != BEST_WAVE_NOT_FIND))
		{//放空处理
			HandleEmpfyCan(TempVailEchoInformation[BestWaveIndex].DistanceV);
		}
		else
		{
			EmptyCan_Wave_Count = 0;
		}
	}
	else
	{
		EmptyCan_Wave_Count = 0;
	}
	return(BestWaveIndex);
}

void	Get_MulEcho_Information(uint8_t TempEchoNumber,uint8_t *TempEchoInfo)
{//传递多回波信息（距离、幅度、分辨率、回波特征）
	uint8_t TempC,TempN;
	uint8_t *TempP;
	for(TempN = 0; TempN < TempEchoNumber; TempN++)
	{
		if(TempN >= MaxVailEchoNumber)
		{
			if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 0)
			{
				VailEchoInformation[TempN].DistanceV = 0;
				VailEchoInformation[TempN].AmplitudeV = 0;
				VailEchoInformation[TempN].EchoDistinctiveness = 0;
				VailEchoInformation[TempN].EchoFeatures = '/';
			}
			else
			{
				VailEchoInformation_ST[TempN].DistanceV = 0;
				VailEchoInformation_ST[TempN].AmplitudeV = 0;
				VailEchoInformation_ST[TempN].EchoDistinctiveness = 0;
				VailEchoInformation_ST[TempN].EchoFeatures = '/';
			}
		}
		if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 0)
		{
			TempP = (uint8_t *)(&VailEchoInformation[TempN]);
		}
		else
		{
			TempP = (uint8_t *)(&VailEchoInformation_ST[TempN]);
		}
		for(TempC = 0; TempC < 8; TempC++)
		{
			*TempEchoInfo = *TempP;
			TempEchoInfo++;
			TempP++;
		}
	}
}

void	ChipInfHandle(uint8_t *ChipDataInf)
{
	uint8_t TempC;
	uint8_t TempEchoNumber;
	if(ChipDataInf[0] <= MAXCHIPNUMBERS)
	{
		for(TempC = 0; TempC < ChipDataInf[0]; TempC++)
		{
			if(ChipDataInf[1+TempC*31] <= MAXVAILDECHONUMBERS)
			{
				IWR1443_ChipInf[TempC].VaildEchoNumber = ChipDataInf[1+TempC*31];
				for(TempEchoNumber = 0; TempEchoNumber < ChipDataInf[1+TempC*31]; TempEchoNumber++)
				{
					IWR1443_ChipInf[TempC].AmplitudeV[TempEchoNumber] = *(( uint16_t* )(&ChipDataInf[6+TempC*31+TempEchoNumber*6]));
					DecipheringEncryption(&ChipDataInf[2+TempC*31+TempEchoNumber*6]);
					IWR1443_ChipInf[TempC].DistanceV[TempEchoNumber] = *(( float* )(&ChipDataInf[2+TempC*31+TempEchoNumber*6]));
					IWR1443_ChipInf[TempC].DistanceV[TempEchoNumber] = DistanceCalibration(IWR1443_ChipInf[TempC].DistanceV[TempEchoNumber]);
				}
			}
		}
	}
	if(IWR1443_Params_Trans.IWR1443_Params.baud_rate == 0)
	{
		if(IWR1443_ChipInf[0].VaildEchoNumber > MaxVailEchoNumber)
		{
			VaildEchoNumber = MaxVailEchoNumber;
		}
		else
		{
			VaildEchoNumber = IWR1443_ChipInf[0].VaildEchoNumber;
		}
		for(TempEchoNumber = 0; TempEchoNumber < VaildEchoNumber; TempEchoNumber++)
		{
			VailEchoInformation[TempEchoNumber].DistanceV = IWR1443_ChipInf[0].DistanceV[TempEchoNumber];
			VailEchoInformation[TempEchoNumber].AmplitudeV = IWR1443_ChipInf[0].AmplitudeV[TempEchoNumber];
			VailEchoInformation[TempEchoNumber].EchoFeatures = '/';
		}
//		if(IWR1443_ChipInf[0].VaildEchoNumber < MaxVailEchoNumber)
			BestWaveIndex_Lcd = HandleMaxPriority(&CurrentEcho_Disappear_Count[0],VaildEchoNumber,VailEchoInformation,GetPreOneSecondEvenValure());
//		else
//			BestWaveIndex_Lcd = HandleMaxPriority(&CurrentEcho_Disappear_Count[0],MaxVailEchoNumber,VailEchoInformation,GetPreOneSecondEvenValure());
		
		UpdateLCDCurveData();
		if(BestWaveIndex_Lcd != BEST_WAVE_NOT_FIND)
		{
			DistanceBuffe[CalDistanceCount] = EchoInf_Weigh.DistanceV[BestWaveIndex_Lcd];
			RecordJumpEchoInfor(VailEchoInformation);	
			QuickOutDistance(DistanceBuffe[CalDistanceCount]);
			CalDistanceCount++;
//			VailEchoInformation[BestWaveIndex].EchoFeatures = 0x3E;//在液晶上显示一个箭头，表示该回波为当前物料回波
//			GetBestEchoInformation(VailEchoInformation);
		}
		GetBestEchoInformation(VailEchoInformation);
//		}
	}
}

void	EchoData_1443(uint16_t *LCDEchoData)
{
	uint8_t TempC;
	uint8_t TempEchoData;
	for(TempC = 0; TempC < IWR1443_WAVEDATA_LENGTH; TempC++)
	{
		TempEchoData = LCDEchoData[TempC]/Amplitude_Zoomout;
		if(IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 0)
		{
			LcdEcho[TempC] = TempEchoData;
		}
		else if(IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 6)
		{
			FakeWave_1443[TempC] = TempEchoData;
		}
	}
}

void	ClearHighNoiseContiuing_Count(void)
{
	HighNoiseContiuing_Count = 0;
}

void	Handle_NoiseCal_EchoSW(void)
{
	uint8_t TempC,TempHNoise_Count;
	TempHNoise_Count = 0;
	for(TempC = 0; TempC < IWR1443_WAVEDATA_LENGTH; TempC++)
	{
		if(TempC > 10)
		{//从第25个点后面开始与设定的噪声门坎值进行比较
			if(LcdEcho[TempC] > Set_MinNoise)
			{
				TempHNoise_Count++;
			}			  
		}
	}
	
	if(TempHNoise_Count > 15)
	{
		RecordPerfToFRAM(HIGHNOISETOTALCOUNT);
		HighNoiseContiuing_Count++;
		RecordMaxPerfToFRAM(HighNoiseContiuing_Count,HIGHNOISECONTINUNGCOUNT);
	}
	else
	{
//		RecordMaxPerfToFRAM(HighNoiseContiuing_Count,HIGHNOISECONTINUNGCOUNT);
		HighNoiseContiuing_Count = 0;
	}
	
	if((FakeCurveFlag != 0)&&(FakeCurveFlag != 6))
	{
		LcdReadFake_Count++;
		if(GetIWR1443_WorkMode() == FakeCurveFlag)
//		if(LcdReadFake_Count >= 1)
		{
			FakeCurveFlag = 6;
			LcdReadFake_Count = 0;
//			IWR1443_Params_Trans.IWR1443_Params.display_points = 100;
		}
		UpdateConfigIWR1443Para();
	}
	else if(FakeCurveFlag == 6)
	{
		LcdReadFake_Count++;
		if(GetIWR1443_WorkMode() == FakeCurveFlag)
//		if(LcdReadFake_Count >= 1)
		{
			FakeCurveFlag = 0;
			LcdReadFake_Count = 0;
		}
		UpdateConfigIWR1443Para();
	}
	if(Calib_Mode_IWR1443 == 0)
	{
		if(IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode != PARTCALIB_MODE)
		{
			IWR1443_Params_Trans.IWR1443_Params.write_calib_params_to_flash = DISABLE;
			IWR1443_Params_Trans.IWR1443_Params.custom_calib_mode = PARTCALIB_MODE;/*校准模式*/
			UpdateConfigIWR1443Para();
		}
	}
	ClearNoSampleSignal();
}

void	HandleSmoothCurve(void)
{
	uint16_t TempI;
	uint8_t TempC;
	uint8_t SmoothP;
	float TempF;
	SmoothP = EepromPara.EepromParaS.ExpandPara.CharPara[5]%10;
	for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
	{
		if(TempI >= SmoothP)
		{
			TempF = EchoBuffer_AV[TempI];
			for(TempC = 1; TempC <= SmoothP; TempC++)
			{
				TempF = TempF+EchoBuffer_AV[TempI+TempC]+EchoBuffer_AV[TempI-TempC];
			}
			CalLowSampleBuffer[TempI] = (uint16_t)(TempF/(SmoothP*2+1));
		}
		else
		{
			CalLowSampleBuffer[TempI] = EchoBuffer_AV[TempI];
		}
	}
}

void	EchoDataHandle(int16_t *EchoData)
{
	uint8_t TempFilter;
	uint16_t TempAmplitude,TempI;
	if(Filter_Count <= EepromPara.EepromParaS.ExpandPara.CharPara[14])
	{
		for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
		{
			if(EchoData[TempI] < 0)
			{
				TempAmplitude = 0;
			}
			else
			{
				TempAmplitude = EchoData[TempI];
			}
			EchoAmplitude_Sum[TempI] = TempAmplitude;
			for(TempFilter = Filter_Count; TempFilter > 0; TempFilter--)
			{
				EchoBuffer[TempFilter][TempI] = EchoBuffer[TempFilter-1][TempI];
				EchoAmplitude_Sum[TempI] = EchoAmplitude_Sum[TempI]+EchoBuffer[TempFilter][TempI];
			}
			EchoBuffer_AV[TempI] = EchoAmplitude_Sum[TempI]/(Filter_Count+1);
			EchoBuffer[0][TempI] = TempAmplitude;

/*			if(IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 0)
			{
				if(TempI > 25)
				{//从第25个点后面开始与设定的噪声门坎值进行比较
					if(CalLowSampleBuffer[TempI] > Set_MinNoise)
					{
						TempHNoise_Count++;
					}			  
				}
			}
			else
			{
				FakeWave[TempI] = CalLowSampleBuffer[TempI];
			}*/
		}
	}
	else
	{
		Filter_Count = EepromPara.EepromParaS.ExpandPara.CharPara[14];
		for(TempI = 0; TempI < SAMPLE_DATA_LENGTH; TempI++)
		{
			if(EchoData[TempI] < 0)
			{
				TempAmplitude = 0;
			}
			else
			{
				TempAmplitude = EchoData[TempI];
			}
			EchoAmplitude_Sum[TempI] = EchoAmplitude_Sum[TempI]-EchoBuffer[Filter_Count][TempI]+TempAmplitude;
			EchoBuffer_AV[TempI] = EchoAmplitude_Sum[TempI]/(Filter_Count+1);
			for(TempFilter = Filter_Count; TempFilter > 0; TempFilter--)
			{
				EchoBuffer[TempFilter][TempI] = EchoBuffer[TempFilter-1][TempI];
			}
			EchoBuffer[0][TempI] = TempAmplitude;

/*			if(IWR1443_Params_Trans.IWR1443_Params.Para_BackUp == 0)
			{
				if(TempI > 25)
				{//从第25个点后面开始与设定的噪声门坎值进行比较
					if(CalLowSampleBuffer[TempI] > Set_MinNoise)
					{
						TempHNoise_Count++;
					}			  
				}
			}
			else
			{
				FakeWave[TempI] = CalLowSampleBuffer[TempI];
			}*/
		}
	}
		Filter_Count++;
		if(Filter_Count >= MAXFLITER_COUNT)
		{
			Filter_Count = MAXFLITER_COUNT;
		}
		HandleSmoothCurve();
		HandleFluctuate();
		IndividualWaveCheckAllRange(CalLowSampleBuffer);
		ConfirmMaxValueWave_Num();
		if(VaildEchoNumber > MaxVailEchoNumber)
		{
			VaildEchoNumber = MaxVailEchoNumber;
		}
		CalVaildEchoDistance();
		BestWaveIndex_Lcd = HandleMaxPriority(&CurrentEcho_Disappear_Count[0],VaildEchoNumber,VailEchoInformation_ST,GetPreOneSecondEvenValure());
		UpdateLCDCurveData();
		if(BestWaveIndex_Lcd != BEST_WAVE_NOT_FIND)
		{
			DistanceBuffe[CalDistanceCount] = EchoInf_Weigh.DistanceV[BestWaveIndex_Lcd];
			RecordJumpEchoInfor(VailEchoInformation_ST);	
			QuickOutDistance(DistanceBuffe[CalDistanceCount]);
			CalDistanceCount++;
//			VailEchoInformation_ST[BestWaveIndex].EchoFeatures = 0x3E;//在液晶上显示一个箭头，表示该回波为当前物料回波
//			GetBestEchoInformation(VailEchoInformation_ST);
		}
		GetBestEchoInformation(VailEchoInformation_ST);
}

float	CalOneSecondPV(void)
{
	uint8_t TempC;
	float	TempMax,TempMin,TempTotal;
	float	TempDistance;
	TempTotal = 0;
	TempMax = 0;
	TempMin = 500;
	for(TempC = 0; TempC < CalDistanceCount; TempC++)
	{
		if(DistanceBuffe[TempC] > TempMax)
			TempMax = DistanceBuffe[TempC];
		if(DistanceBuffe[TempC] < TempMin)
			TempMin = DistanceBuffe[TempC];
		TempTotal = TempTotal+DistanceBuffe[TempC];
	}
	if(CalDistanceCount > 2)
	{
		TempDistance = (TempTotal-TempMin-TempMax)/(CalDistanceCount-2);
	}
	else if(CalDistanceCount > 0)
	{
		TempDistance = TempTotal/CalDistanceCount;
	}
	else
	{
		TempDistance = GetPreOneSecondEvenValure();
	}
	CalDistanceCount = 0;
	return(TempDistance);
}

void	GetFakeCurveInfo(void)
{
	uint8_t TempC;
	uint16_t tempy;
	uint16_t StartIndex,StartIndexX;
	uint16_t IndexX;
	float Zoomout_In_X;
	if(IWR1443_Params_Trans.IWR1443_Params.baud_rate != 0)
	{
		StartIndex = DistanceOutToPointIndexInt(LCDCurveStart);//(uint16_t)(LCDCurveStart/OnePoint_M_Para);
		StartIndexX = StartIndex;
		Zoomout_In_X = DistanceOutToPointIndexInt(LCDCurveEnd-LCDCurveStart);//(LCDCurveEnd-LCDCurveStart)/OnePoint_M_Para;
		Zoomout_In_X = Zoomout_In_X/LCDCURVE_LENGH;
		for(TempC = 0;TempC < LCDCURVE_LENGH; TempC++)
		{	
			IndexX = (uint16_t)(StartIndex+TempC*Zoomout_In_X);
			tempy = FakeWave[IndexX]/Amplitude_Zoomout;
			for(; StartIndexX <= IndexX; StartIndexX++)
			{
				if((FakeWave[StartIndexX]/Amplitude_Zoomout) > tempy)
					tempy = FakeWave[StartIndexX]/Amplitude_Zoomout;
				if(tempy > 255)
					tempy = 255;
				FakeWave_1443[TempC] = tempy;
			}
			if(StartIndexX > IndexX)
			{
				FakeWave_1443[TempC] = FakeWave[StartIndexX]/Amplitude_Zoomout;
			}
			StartIndexX = IndexX+1;
		}
	}
}

void	SendReadFakeCurveInfo(uint8_t *TempCurveInfo)
{
	TempCurveInfo[0] = FakeWave_1443[98];
	TempCurveInfo[1] = FakeWave_1443[99];
}

void	SendFakeCurveInfo(uint8_t *TempCurveInfo)
{
	uint8_t TempC;
	GetFakeCurveInfo();
	for(TempC = 0; TempC < 100; TempC++)
	{
		TempCurveInfo[TempC] = FakeWave_1443[TempC];
	}
}

void	TransmitCurveInfo(uint8_t *TempDataBuffer,uint8_t TempStartDot,uint8_t TempNumber,uint8_t CurveSL)
{
	uint8_t TempC;
	if(CurveSL == 0)
	{
		for(TempC = 0; TempC < TempNumber; TempC++)
		{
			TempDataBuffer[TempC] = LcdEcho[TempC+TempStartDot];
		}
	}
	else
	{
		if(TempStartDot == 0)
			GetFakeCurveInfo();
		for(TempC = 0; TempC < TempNumber; TempC++)
		{
			TempDataBuffer[TempC] = FakeWave_1443[TempC+TempStartDot];
		}
	}
}

 /***************************************************************************
  * @Description: 二分法查表 （升序表）
  * @param : x为待查找元素，N为有序表大小
  * @fixme: NULL
  * @Author: xcg
  * @Date: 2022.2.9
  ***************************************************************************/
 int TableSearch(float x,int N)  
 {  
     int left=0,right=N-1,mid;
     if(x > FFT_LOG_TABLE[N-1][0])
        return -2;                      //查找数据超范围
     while(left<=right)
    {
        mid = (left+right)/2;
        if(left == right)
            return  mid;                //查找成功返回就返回索引
        if(x == FFT_LOG_TABLE[mid][0]) 
            return  mid;                //查找成功返回就返回索引
        else if(x < FFT_LOG_TABLE[mid][0])
        {
            if(x > FFT_LOG_TABLE[mid-1][0])
                return mid;
            else
                right = mid-1;
        }
        else 
        {
            if(x < FFT_LOG_TABLE[mid+1][0])
                return mid;
            else
                left = mid+1;
        }

     }
     return -1;                         //查找失败
 }
/***************************************************************************
 * @Description: 计算FFT的对数值
 * @param : 查找近似值后，再进行一步线性计算
 * @fixme: NULL
 * @Author: xcg
 * @Date: 2022.2.9
 ***************************************************************************/
float Calculate_Log(float FFT_Value)
{
    int index_search;
    float Calculate_Value;

    index_search = TableSearch(FFT_Value,TABLE_CAL_SIZE);

    if(index_search < 0)
       return 0;
    else
       Calculate_Value = FFT_LOG_TABLE[index_search-1][1]+(FFT_LOG_TABLE[index_search][1]-FFT_LOG_TABLE[index_search-1][1])*(FFT_Value-FFT_LOG_TABLE[index_search-1][0])/(FFT_LOG_TABLE[index_search][0]-FFT_LOG_TABLE[index_search-1][0]);

    return Calculate_Value;
}

/***************************************************************************
 * @Description: 窗函数计算+添加虚部  data为偏移后数据
 * @param : NULL
 * @fixme: NULL
 * @Author: xcg
 * @Date: 2021.12.25
 ***************************************************************************/
void	ADD_Win_FUN(float *data,uint16_t datalen)
{
	uint16_t i;
	ADC_Total_Count++;
	if(ADC_Total_Count > EepromPara.EepromParaS.ExpandPara.CharPara[20])
	{
		for(uint16_t i=0;i<1024;i++)
		{
			ADC_Minus_Data[i] = ADC_IW1443Data[i]/ADC_Total_Count;
			ADC_IW1443Data[i] = 0;
		}
		ADC_Total_Count = 0;
	}
	else
	{
		for(uint16_t i=0;i<1024;i++)
		{
			ADC_Minus_Data[i] = ADC_IW1443Data[i]/ADC_Total_Count;
		}
	}
	
	if(IWR1443_Params_Trans.IWR1443_Params.code_window != 0)
	{
		for(i=0;i<512;i++)
		{
//			if(Sample_Length_Index == 512)//ADC_SAMPLES_512)
//			{
				ADC_Minus_Data[2*i]  =  ADC_Minus_Data[2*i]*WIN_BLACKMAN[i];
				ADC_Minus_Data[2*i+1] = ADC_Minus_Data[2*i+1]*WIN_BLACKMAN[i];
/*			}
			else if(Sample_Length_Index == 1024)//ADC_SAMPLES_1024)
			{
				ADC_Win_Data[2*i]  =  ((float32_t)(*(data+2*i)))*WIN_BLACKMAN_1024[i];
				ADC_Win_Data[2*i+1] = ((float32_t)(*(data+2*i+1)))*WIN_BLACKMAN_1024[i];
			}*/
/*			if(ZERO_TIMES == 2)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;
			}
			else if(ZERO_TIMES == 4)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;   
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*2] = 0;             
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*3] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*3] = 0;       
			}
			else if(ZERO_TIMES == 8)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;   
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*2] = 0;             
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*3] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*3] = 0;       
//				ADC_Minus_Data[2*i+Sample_Length_FFT*2*4] = 0;
//				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*4] = 0;       
			}*/
		}
	}
	else
	{
		for(i=0;i<512;i++)
		{
			ADC_Minus_Data[2*i]  =  ADC_Minus_Data[2*i];
			ADC_Minus_Data[2*i+1] = ADC_Minus_Data[2*i+1];
/*			if(ZERO_TIMES == 2)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;
			}
			else if(ZERO_TIMES == 4)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;   
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*2] = 0;             
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*3] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*3] = 0;       
			}
			else if(ZERO_TIMES == 8)
			{
				ADC_Minus_Data[2*i+Sample_Length_FFT*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2] = 0;   
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*2] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*2] = 0;             
				ADC_Minus_Data[2*i+Sample_Length_FFT*2*3] = 0;
				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*3] = 0;       
//				ADC_Minus_Data[2*i+Sample_Length_FFT*2*4] = 0;
//				ADC_Minus_Data[2*i+1+Sample_Length_FFT*2*4] = 0;       
			}*/
		}
	}
	// AD采样值赋值
/*	for(i=0;i<FFTSAMPLENGTH;i++)
	{
		ADC_Win_Data[2*i]  =  ((float32_t)(*(data+2*i)))*WIN_BLACKMAN[i];
		ADC_Win_Data[2*i+1] = ((float32_t)(*(data+2*i+1)))*WIN_BLACKMAN[i];
	}*/
}

/***************************************************************************
 * @Description: 数据处理
 * @param : NULL
 * @fixme: NULL
 * @Author: xcg
 * @Date: 2021.12.24
 ***************************************************************************/
void	Sample_Data_Process(int16_t *EchoData)
{
	float ADC_Mean;
	float ADC_Mean_Q;
//	ZERO_TIMES = GetZeroFill_Times();
//	Sample_Length_Index = GetSample_Length_Index();   
//	Sample_Length_FFT = (32<<Sample_Length_Index);
	
//	arm_cfft_radix2_instance_f32 arm_cfft_AD_1024; 
	/*多chirp 平均*/
//	for(uint32_t i=0;i<Sample_Length_FFT*2;i++)
//		ADSampleDataSum[i] = EchoData[i]/GetRFChipNum();    
	/*取平均*/
	ADC_Mean=0.0f;
	ADC_Mean_Q = 0.0f;
	for(uint16_t i=0;i<512;i++){
		ADC_Mean = ADC_Mean+(float)(EchoData[i*2]);
		ADC_Mean_Q = ADC_Mean_Q+(float)(EchoData[i*2+1]);
	}
	
	ADC_Mean = ADC_Mean/512;
	ADC_Mean_Q = ADC_Mean_Q/512;
	/*去直流*/
	for(uint16_t i=0;i<512;i++)
	{
		ADC_IW1443Data[i*2+1] = ADC_IW1443Data[i*2+1]+(float)EchoData[i*2]-ADC_Mean;
		ADC_IW1443Data[i*2] = ADC_IW1443Data[i*2]+(float)EchoData[i*2+1]-ADC_Mean_Q;
		EchoData[i*2] = 0;
		EchoData[i*2+1] = 0;
	} 
		
	ADD_Win_FUN(ADC_IW1443Data,Sample_Length_FFT);
	
	for(uint16_t i=1024;i<FFT_NUMBER;i++)
	{
		ADC_Minus_Data[i] = 0;
	}
	
	/*FFT + 补零*/
	if(ZERO_TIMES == 1)
	{
//		if(Sample_Length_Index == ADC_SAMPLES_512)
			arm_cfft_f32(&arm_cfft_sR_f32_len512,ADC_Minus_Data,0,1);
//		else if(Sample_Length_Index == ADC_SAMPLES_1024)
//			arm_cfft_f32(&arm_cfft_sR_f32_len1024,ADC_Win_Data,0,1);
	}
	else if(ZERO_TIMES == 2)
	{
//		if(Sample_Length_Index == 512)//ADC_SAMPLES_512)
			arm_cfft_f32(&arm_cfft_sR_f32_len1024,ADC_Minus_Data,0,1);
//		else if(Sample_Length_Index == ADC_SAMPLES_1024)
//			arm_cfft_f32(&arm_cfft_sR_f32_len2048,ADC_Win_Data,0,1);
	}
	else if(ZERO_TIMES == 4) 
	{
//		if(Sample_Length_Index == ADC_SAMPLES_512)
			arm_cfft_f32(&arm_cfft_sR_f32_len2048,ADC_Minus_Data,0,1);
//		else if(Sample_Length_Index == ADC_SAMPLES_1024)
//			arm_cfft_f32(&arm_cfft_sR_f32_len4096,ADC_Win_Data,0,1);      
	}
	else if(ZERO_TIMES == 8) 
	{
//		if(Sample_Length_Index == ADC_SAMPLES_512)
			arm_cfft_f32(&arm_cfft_sR_f32_len4096,ADC_Minus_Data,0,1);
//		else if(Sample_Length_Index == ADC_SAMPLES_1024)
//			arm_cfft_f32(&arm_cfft_sR_f32_len4096,ADC_Win_Data,0,1);      
	}
	arm_cmplx_mag_f32(ADC_Minus_Data,FFTOutput_Float_Buffer, Sample_Length_FFT*ZERO_TIMES);
	/*FFT */
	FFTOutput_Float_Buffer[0] = FFTOutput_Float_Buffer[0]/Sample_Length_FFT;
	for(uint16_t i=1;i<SAMPLE_DATA_LENGTH;i++)
	{
		FFTOutput_Float_Buffer[i] = FFTOutput_Float_Buffer[i]/Sample_Length_FFT/2;
	}
	/*取log*/
	for(uint16_t i=0;i<SAMPLE_DATA_LENGTH;i++)
	{
		EchoData[i] = (int16_t)(GetRFGainPara()*log(FFTOutput_Float_Buffer[i]+1));
//		FFT_AveOutput_Buffer[i] = Calculate_Log(FFTOutput_Float_Buffer[i]);
	}
	EchoDataHandle(EchoData);
}
